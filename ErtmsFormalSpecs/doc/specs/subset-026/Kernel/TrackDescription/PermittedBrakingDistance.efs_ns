<NameSpace
 X="230"
 Y="10"
 Width="100"
 Height="50"
 Name="PermittedBrakingDistance"
 Guid="04dc141f-d4cc-4fa5-881e-4b2bbd65f769"
>
<NameSpaces>
</NameSpaces>
<Structures>
<Structure
 Default=""
 X="230"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SRPBDStruct"
 Guid="a3778cf9-457b-4cab-b6de-40b9c7dae434"
>
<ReqRef
 Id="588756eb-1786-4776-86ae-3aaa296881a9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="47130d6d-d31a-46c2-aeb2-bddffa9cb33d"
>
</ReqRef><ReqRef
 Id="7286d7a7-e1e5-4269-ae7b-f3e6ff5a129f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bfba847b-787d-4617-ad7a-972ac93c113c"
>
</ReqRef><ReqRef
 Id="256eb4d5-6af7-4f58-b1ad-b1fd498be1d7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4863af56-2423-4051-891d-9238b5496c6e"
>
</ReqRef><Comment>Represents a speed restriction to ensure permitted braking distance.</Comment>
<StructureElement
 TypeName="BaseTypes.Distance"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Location"
 Guid="c437f494-311b-4a54-9521-224db2568f39"
>
<ReqRef
 Id="62a07b67-97e4-40f8-a86f-1d21dcd16825"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a966914c-62fc-4780-8c66-82812e8e0f01"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Length"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Length"
 Guid="f33bffc9-68f3-4459-9598-b1fb2baf8b75"
>
<ReqRef
 Id="62a07b67-97e4-40f8-a86f-1d21dcd16825"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="346c6365-ded8-411a-9145-e4363ed58fc4"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Speed"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Speed"
 Guid="786f9486-a6b3-4963-a237-83bdfa2c8241"
>
</StructureElement><StructureElement
 TypeName="BaseTypes.Gradient"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Gradient"
 Guid="ef6d941c-60e9-424d-888d-1b815554ec27"
>
<ReqRef
 Id="1202840c-6fc7-4cd2-ae85-f73c589ab130"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="018eaa4c-e82c-4237-bcc1-82dc5efca6ac"
>
</ReqRef></StructureElement><StructureElement
 TypeName="Messages.Q_PBDSR"
 Default="Messages.Q_PBDSR.EB_intervention_requested"
 Mode="Internal"
 Implemented="TRUE"
 Name="BrakeType"
 Guid="f76f9d57-c9de-4b4a-808a-fd7b7fa187aa"
>
<ReqRef
 Id="515d7e3c-4a92-447b-b6fc-48e59f80a35d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="95fc612c-34ff-4545-873c-4092264fa4e3"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Distance"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="BrakingDistance"
 Guid="781ab1e1-ab27-46e9-a633-38b27e0f8dbe"
>
<ReqRef
 Id="127e68f8-f2a3-40b4-a939-94583902b93b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89380bf4-0da8-4e2a-b952-ccb1e09ddadb"
>
</ReqRef></StructureElement><Interfaces>
<StructureRef
 Name="BaseTypes.LocationLengthInterface"
 Guid="6bb7c96f-6908-45a8-850f-9d3f0be1a63b"
>
</StructureRef></Interfaces>
</Structure><Structure
 Default=""
 X="10"
 Y="110"
 Width="100"
 Height="50"
 NeedsRequirement="FALSE"
 Name="SRPBDProfileStruct"
 Guid="2995ce6b-ecff-4aef-b477-4b3d72c29141"
>
<Comment>Represents the speed restrictions to ensure permitted braking distance.</Comment>
<StructureElement
 TypeName="Messages.Q_TRACKINIT"
 Default="Messages.Q_TRACKINIT.No_initial_states_to_be_resumed__profile_to_follow"
 Mode="Internal"
 Implemented="TRUE"
 Name="InitialState"
 Guid="09bda95b-5727-4cf4-b9fb-e91bdc8e63eb"
>
<ReqRef
 Id="13a5ea24-0fd2-4281-99df-f3585e1e8e67"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0f9f8452-842e-4f9a-9b11-e4082079edcc"
>
</ReqRef></StructureElement><StructureElement
 TypeName="BaseTypes.Distance"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="EmptyProfileDistance"
 Guid="6bf7ff32-439e-4e5d-a35c-0099fb2eb6a2"
>
<ReqRef
 Id="35ef498a-1c12-4203-b283-26436d281f11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3ed4950b-a389-4ff4-8453-e1bff5bfdd66"
>
</ReqRef></StructureElement><StructureElement
 TypeName="SRPBs"
 Default="[]"
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SpeedRestrictions"
 Guid="a22a4be3-0a0e-4c75-a916-bb18e1d3ec74"
>
</StructureElement></Structure></Structures>
<Collections>
<Collection
 TypeName="SRPBDStruct"
 MaxSize="20"
 Default="[]"
 X="230"
 Y="110"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="SRPBs"
 Guid="ee114266-3859-4cfd-ab85-c163a95cb319"
>
<ReqRef
 Id="7286d7a7-e1e5-4269-ae7b-f3e6ff5a129f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2d029bbe-638e-4f49-9f27-da66a1b530d2"
>
</ReqRef><Comment>Represents the speed restrictions to ensure permitted braking distance.</Comment>
</Collection></Collections>
<Functions>
<Function
 Type="SRPBDStruct"
 Default=""
 X="10"
 Y="310"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="CreateNewSpeedRestriction"
 Guid="72a8b72d-3072-46bc-9ecf-9b4b82daabfa"
>
<ReqRef
 Id="62a07b67-97e4-40f8-a86f-1d21dcd16825"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e51c2cc6-6eeb-4d74-87fd-605f2070882d"
>
</ReqRef><ReqRef
 Id="127e68f8-f2a3-40b4-a939-94583902b93b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d8ce850a-c5aa-4fd7-b4c7-481b975f9447"
>
</ReqRef><ReqRef
 Id="515d7e3c-4a92-447b-b6fc-48e59f80a35d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="458b8819-4bf2-4a59-81b0-e28fd1f70ee4"
>
</ReqRef><ReqRef
 Id="1202840c-6fc7-4cd2-ae85-f73c589ab130"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8816156b-6284-4871-a746-ec369d11b79c"
>
</ReqRef><ReqRef
 Id="7286d7a7-e1e5-4269-ae7b-f3e6ff5a129f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7830a51c-bcba-4f38-8742-ce9426415c9f"
>
</ReqRef><Comment>Creates a new speed restriction to ensure permitted braking distance.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="Location"
 Guid="8a3fe94e-0b07-4e78-ac40-152eece069a4"
>
</Parameter><Parameter
 Type="BaseTypes.Length"
 Name="Length"
 Guid="c9e0a857-4edc-4a30-b4de-4c47c97b1fab"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="PermittedBrakingDistance"
 Guid="9ed4fb41-7caf-4f1d-a650-eea9c8d86186"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="90200558-cac3-47b1-bed3-059689e38ef1"
>
</Parameter><Parameter
 Type="Messages.Q_PBDSR"
 Name="BrakeType"
 Guid="78d8cad5-e785-43f5-b6a9-55d8f20ed39c"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="aDistanceFromRef"
 Guid="78b0696b-288a-4117-b64f-b79b951aaf28"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="58a6586b-b703-4c7f-a7ab-c0a008b09195"
>
<Expression>Kernel.TrackDescription.PermittedBrakingDistance.SRPBDStruct
{
    BrakingDistance =&gt; PermittedBrakingDistance,
    BrakeType =&gt; BrakeType,
    Gradient =&gt; Gradient,
    Location =&gt; aDistanceFromRef + Location,
    Length =&gt; Length,
    Speed =&gt; ComputePermittedSpeed ( PermittedBrakingDistance =&gt; PermittedBrakingDistance, Gradient =&gt; Gradient, BrakeType =&gt; BrakeType )
}</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="120"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ComputePermittedSpeed"
 Guid="fdda0714-2f08-468b-9aa5-db0b8389b3d4"
>
<ReqRef
 Id="09e2410c-62cb-42ab-b7f9-21ab9940cbc7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7038a3a6-9a74-4b2e-a280-a79f697bea0c"
>
</ReqRef><ReqRef
 Id="6b0803c4-fc83-41dd-bcfd-d53de1634680"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="efc1a321-4590-4d2a-8286-f992305556f1"
>
</ReqRef><ReqRef
 Id="ffb98aeb-e620-476c-8ca6-7b57a2bdf860"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="108a7b30-105c-4b58-9d5d-ea956f1f5a94"
>
</ReqRef><ReqRef
 Id="142a3c74-1f88-416b-bcd7-7c7781199737"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0a102b2d-a0b0-4bac-9846-8a57206da992"
>
</ReqRef><ReqRef
 Id="256eb4d5-6af7-4f58-b1ad-b1fd498be1d7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2571039c-648a-4338-9166-6d12e3ec0840"
>
</ReqRef><ReqRef
 Id="033c7194-4880-4392-826b-611b7e266476"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="71efcfab-9d22-4033-a983-c89e2ebddfa2"
>
</ReqRef><ReqRef
 Id="8c7db48b-2e9f-4028-9811-c07cc373b1cc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f9feac13-1780-4b38-beda-d1bb2bc56744"
>
</ReqRef><ReqRef
 Id="bb553624-3428-4035-ae99-df4bea6282e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0f0edd67-a055-4dfa-9b17-f1222044fefc"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="58517f25-2f46-4ada-99e1-72bbf8619dc5"
>
</ReqRef><Comment>Computes the permitted speed for a speed restriction to ensure permitted braking distance.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="PermittedBrakingDistance"
 Guid="8c3c1d97-0e20-43d2-bd6d-70486581351d"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="1b8c19c7-e7e5-4fa9-8f8c-d56294ae35f7"
>
</Parameter><Parameter
 Type="Messages.Q_PBDSR"
 Name="BrakeType"
 Guid="d384270d-8a8d-44f9-8335-270d8a8c3653"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="EB"
 Guid="1323899b-9fa0-4934-9a84-141b821de50a"
>
<PreConditions>
<PreCondition
 Guid="d7d70801-f807-432c-be32-68ab4529c806"
>BrakeType == Messages.Q_PBDSR.EB_intervention_requested</PreCondition></PreConditions>
<Expression>RoundToMultiple(
    Value =&gt; Kernel.TrackDescription.PermittedBrakingDistance.ComputePermittedSpeedForEB( d_PBD =&gt; PermittedBrakingDistance, Gradient =&gt; Gradient ),
    Multiple =&gt; 5.0
)</Expression>
</Case><Case
 Name="SB"
 Guid="cf62ff4f-7221-4e5b-8d1f-ed2445553643"
>
<Expression>RoundToMultiple (
    Value =&gt; Kernel.TrackDescription.PermittedBrakingDistance.ComputePermittedSpeedForSB (
        PermittedBrakingDistance =&gt; PermittedBrakingDistance,
        Gradient =&gt; Gradient ),
    Multiple =&gt; 5.0
)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="230"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ComputePermittedSpeedForSB"
 Guid="51b7e8a2-a2f3-499f-9794-248e4bd4dff0"
>
<ReqRef
 Id="09e2410c-62cb-42ab-b7f9-21ab9940cbc7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8d071e71-8966-4f84-aa88-2b88362dc5fd"
>
</ReqRef><ReqRef
 Id="033c7194-4880-4392-826b-611b7e266476"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4f6369e8-d856-463d-8bec-f6f58a1adc4f"
>
</ReqRef><ReqRef
 Id="bb553624-3428-4035-ae99-df4bea6282e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fbd06aa1-7577-47a6-9071-6a2cec045dc7"
>
</ReqRef><ReqRef
 Id="8c7db48b-2e9f-4028-9811-c07cc373b1cc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a488b00f-c14a-482b-ac0b-6cc7403f4ae5"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c2ce3fe1-6c7d-4a03-9c1d-0c599d5b67a8"
>
</ReqRef><Comment>Computes SB ceiling speed intervention value for a speed restriction to ensure permitted braking distance.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="PermittedBrakingDistance"
 Guid="3fe2a803-b212-4030-affa-1a99a5c9ff82"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="035c5457-66f1-437d-b55e-7bf9056a9282"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="e94a30d4-4c1e-4d97-a556-fb5305537c4c"
>
<Expression>BaseTypes.MinSpeed(
    X1 =&gt; Kernel.TrackDescription.PermittedBrakingDistance.PermittedSpeedForSB_EB( d_PBD =&gt; PermittedBrakingDistance, Gradient =&gt; Gradient ),
    X2 =&gt; Kernel.TrackDescription.PermittedBrakingDistance.PermittedSpeedForSB_SB( d_PBD =&gt; PermittedBrakingDistance, Gradient =&gt; Gradient )
)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Distance"
 Default=""
 X="120"
 Y="310"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="Dbec"
 Guid="c21f881b-d886-45ff-bed7-bab1d5e1a2e8"
>
<ReqRef
 Id="d7b72e8e-080e-4419-87c9-e54ecdfed0ef"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cd255157-9f1b-457a-bdd7-67a8c0037883"
>
</ReqRef><ReqRef
 Id="9e5b33ae-9b18-4cc2-a313-bbacf0e3cf57"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bc321fca-17c5-4f93-b624-e81b76adfbd6"
>
</ReqRef><ReqRef
 Id="4486b27f-175f-416b-966b-36a45f3533dd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2592bbe3-5f19-43af-bfb0-7092ba779339"
>
</ReqRef><ReqRef
 Id="e87f780e-c98b-4fa1-8fc6-fa1095bf905f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="dceaa548-fc85-4a3c-9b6c-976217512149"
>
</ReqRef><ReqRef
 Id="d4a81249-71de-4107-8751-642bb154bb84"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="de50a32d-0600-4d36-afd7-0f1600d8edc5"
>
</ReqRef><ReqRef
 Id="7a7e3aa4-8bc1-41f9-86fa-a8f1795b69f0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d759bb2d-f3f7-461e-9f9e-181712740338"
>
</ReqRef><Comment>Provides the distance travelled during the time elapsed between the Emergency brake intervention and the full application of the braking effort.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V_PBD"
 Guid="88a3ad4a-103b-4e84-b8c1-2509d26f5507"
>
</Parameter><Parameter
 Type="BaseTypes.Speed"
 Name="dV"
 Guid="8524eab8-3ef9-46c6-acb8-3c0cdbefe540"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="626b0f44-abec-4e4e-a2e4-67111dc5b3c1"
>
<Expression>BaseTypes.SpeedToMS( V_PBD + dV + Kernel.TrackDescription.PermittedBrakingDistance.Vdelta0PBD(V_PBD) ) * ( SpeedAndDistanceMonitoring.DecelerationCurves.Parameters.T_traction(True) + SpeedAndDistanceMonitoring.DecelerationCurves.Parameters.T_berem(True) )</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="340"
 Y="310"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="Vdelta0PBD"
 Guid="25c05d76-e738-4198-b39e-efd3cdcbaefa"
>
<ReqRef
 Id="28e8fd74-8da8-4c8d-9d0b-2b3de6dea1ac"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6221e25a-6d61-4cf5-8a73-465103ab38a2"
>
</ReqRef><ReqRef
 Id="9e5b33ae-9b18-4cc2-a313-bbacf0e3cf57"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1a89fb0a-39f0-4597-abb8-e1a655f8bf8e"
>
</ReqRef><ReqRef
 Id="603addf7-8a2f-4b2c-8e61-6c2de3f220f7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d1e29328-931b-49df-ac9d-4b4c3a5b51ea"
>
</ReqRef><ReqRef
 Id="7b334033-590c-4e04-b98a-1973062cc426"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cc9158cd-a0a3-4622-9e41-63f340be5f2a"
>
</ReqRef><ReqRef
 Id="cbdd4a98-e47d-4d4a-be99-b19a44519a2f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ca4938da-e57f-4d82-a7f2-d68f7799908e"
>
</ReqRef><Comment>Provides the value of Vdelta0 for speed restrictions to ensure permitted braking distance.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V_PBD"
 Guid="cf3822cd-3178-49e6-a46d-c0f600a54143"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Compensation of speed inaccuracy is inhibited by NV"
 Guid="cac05486-62b7-4d2b-8c03-8ddb0b0cb7b4"
>
<PreConditions>
<PreCondition
 Guid="44484dba-c965-4e53-b13d-f63a06ed43cb"
>Kernel.NationalValues.CompensationOfInaccuracyOfTheSpeedIsInhibited()</PreCondition></PreConditions>
<Expression>0.0</Expression>
</Case><Case
 Name="Compensation of speed inaccuracy is not inhibited by NV"
 Guid="a19d201e-cd5f-4b60-bcf6-a4ea5c891e82"
>
<Expression>Kernel.SpeedAndDistanceMonitoring.f41(V_PBD)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Acceleration"
 Default=""
 X="10"
 Y="190"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="A_safe"
 Guid="ff987aec-c295-4490-9d64-fa62fe5e15ba"
>
<ReqRef
 Id="c05a1b7d-e40a-429a-a666-9fb637623918"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1f47b546-5ed4-495a-9c53-1490965ce0d0"
>
</ReqRef><ReqRef
 Id="6dae0a46-987c-4993-aa8d-ea721518ec6b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="94664658-f189-404f-9006-2de942d94fbb"
>
</ReqRef><ReqRef
 Id="7398172b-264c-4ff9-8f60-3b1e043f2033"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fddd5b38-ef76-42a5-b18a-1deac3e73c34"
>
</ReqRef><ReqRef
 Id="9321d0a2-9ea3-4834-adc7-1f1fb0ec70db"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a9b0f30d-73e9-402d-900e-2773af70ac9e"
>
</ReqRef><ReqRef
 Id="c7a43456-5326-4c4d-b89f-23b71a0240bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e916cec0-660c-471a-8426-63a4f422645d"
>
</ReqRef><ReqRef
 Id="00117c31-ed13-4768-8e1a-ea0cc12ad9c6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="40b9b4e8-11ae-4852-b479-246e72954ef2"
>
</ReqRef><ReqRef
 Id="2c111d3d-6708-48ec-ae52-2f2dd5ea8d7f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7005a401-ce82-4efd-b415-a87c91bc45b7"
>
</ReqRef><ReqRef
 Id="08b9f07e-b517-412e-8ea3-adc1aa89cba0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="97a25e34-02e1-423b-8987-2b5247f9ac42"
>
</ReqRef><Comment>Computes the safe deceleration of the train, with gradient 0.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="d"
 Guid="5ba89e8d-d904-4e28-a126-f873efb6867b"
>
</Parameter><Parameter
 Type="BaseTypes.Speed"
 Name="V"
 Guid="368784ff-fe45-40af-b9af-3b3acc4146ac"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="ad610295-3eb0-4d5d-babd-ffbfc8186b48"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="9831a397-3452-409b-b947-ead08c8c96b4"
>
<Expression>(
    REDUCE
        Kernel.TrackDescription.AdhesionFactors.AdhFactors
    USING X IN
        Override
        (
            Default =&gt; RESULT,
            Override =&gt; FUNCTION d :  BaseTypes.Distance, V : BaseTypes.Speed =&gt; Kernel.TrackDescription.PermittedBrakingDistance.A_safe_forAdhesionFactor ( anAdhFactor =&gt; X, d =&gt; d, V =&gt; V, Gradient =&gt; Gradient )
        )
    INITIAL_VALUE
        FUNCTION d :  BaseTypes.Distance, V : BaseTypes.Speed =&gt; Kernel.TrackDescription.PermittedBrakingDistance.Default_A_safe ( d =&gt; d, V =&gt; V, Gradient =&gt; Gradient )
)
(d, V)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Acceleration"
 Default=""
 X="230"
 Y="190"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="A_safe_forAdhesionFactor"
 Guid="dc41e8e5-5660-4ff8-9008-a987e8a87ecc"
>
<ReqRef
 Id="3a290d20-7245-41fa-a2ae-84a3585ce63b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3b2f6d7f-ccdd-4312-bc02-8c0921c3063d"
>
</ReqRef><ReqRef
 Id="9479529b-7ed6-4961-b08a-7bcb18714d1a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0cbd5687-fcc8-4369-b2e8-3e092b799ecc"
>
</ReqRef><ReqRef
 Id="c05a1b7d-e40a-429a-a666-9fb637623918"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a6018579-fb55-4c41-a58e-876370f71aec"
>
</ReqRef><ReqRef
 Id="f3bcff62-12ff-4959-a7b5-1a7089516acb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d76c41c5-c4ce-4976-a922-fa2ffc7f2f66"
>
</ReqRef><ReqRef
 Id="f9c0f0b7-0cba-4cee-ba0c-25c654215c74"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ccd603ac-d1f1-4208-9cac-1c82cdbecc30"
>
</ReqRef><ReqRef
 Id="c99601f4-d6ed-4f84-988c-9fbc856fdb87"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="567204c9-8593-42b5-9e88-06257b76a3c0"
>
</ReqRef><ReqRef
 Id="1103bf93-0534-41aa-a8dc-d09b48c38d5e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="129f99f2-9921-4ceb-a6ed-a67ff3f90774"
>
</ReqRef><ReqRef
 Id="51ee044c-b79a-4329-b477-4569763b65d1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5e993b31-689f-4807-a38a-3f5e2e339cc5"
>
</ReqRef><ReqRef
 Id="2c111d3d-6708-48ec-ae52-2f2dd5ea8d7f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="31d49e83-3e64-4947-8b4a-3637648c4737"
>
</ReqRef><ReqRef
 Id="055c5fba-df70-4327-b944-0ef3656ee194"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b11d86f5-1038-4bf5-a25e-c749a00423ba"
>
</ReqRef><ReqRef
 Id="08b9f07e-b517-412e-8ea3-adc1aa89cba0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="80731477-68c2-4bd9-bd46-ad7d3e94971b"
>
</ReqRef><Comment>Provides value of A_safe for adhesion factor slippery rail with gradient 0.</Comment>
<Parameters>
<Parameter
 Type="AdhesionFactors.AdhesionFactorStruct"
 Name="anAdhFactor"
 Guid="ad9ff0e8-6784-4bcb-8310-c6ee0f1274dd"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="d"
 Guid="6ad193c2-7fb9-44e0-9404-703569bfc21a"
>
</Parameter><Parameter
 Type="BaseTypes.Speed"
 Name="V"
 Guid="87ea9f1c-57cc-4716-ba4e-f7aebac9bcf4"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="25fc3bc1-4f88-4ead-8ee1-6f6f0f67ed2b"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Slippery Rail (driver selected)"
 Guid="5bd0c650-2a48-42a5-940b-82a88da29e2c"
>
<PreConditions>
<PreCondition
 Guid="099356aa-bb6a-4569-96cc-bd9497a47543"
>AdhesionFactors.SlipperyRailSelectedByDriver</PreCondition></PreConditions>
<Expression>( MIN ( Kernel.TrackDescription.PermittedBrakingDistance.A_brake_safe (V), Kernel.NationalValues.A_MAXREDADH () ) + Kernel.TrackDescription.PermittedBrakingDistance.A_gradient(Gradient) ) (V)</Expression>
</Case><Case
 Name="Adhesion factor available (trackside)"
 Guid="fdcbba77-4eb9-4b7f-9ac6-54da14511424"
>
<PreConditions>
<PreCondition
 Guid="49182ebe-0de5-436a-bc60-ccb48241b9e0"
>d &lt; anAdhFactor.Location + BaseTypes.LengthToDistance ( Kernel.TrackDescription.AdhesionFactors.AdhFactorLength ( anAdhFactor ) )</PreCondition><PreCondition
 Guid="96d93cb8-5eac-4f52-b211-9fc3b66f1670"
>anAdhFactor.Location &lt;= d</PreCondition><PreCondition
 Guid="db33952f-0acc-4003-8b05-5fcf9b2fa7c3"
>anAdhFactor.Value == Messages.M_ADHESION.Slippery_rail</PreCondition></PreConditions>
<Expression>( MIN ( Kernel.TrackDescription.PermittedBrakingDistance.A_brake_safe (V), Kernel.NationalValues.A_MAXREDADH () ) + Kernel.TrackDescription.PermittedBrakingDistance.A_gradient(Gradient) ) (V)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Acceleration"
 Default=""
 X="120"
 Y="190"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="Default_A_safe"
 Guid="69eff3b7-a426-44c8-bd99-aa655ab5379d"
>
<ReqRef
 Id="c05a1b7d-e40a-429a-a666-9fb637623918"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e378d6e7-86d7-4082-9dd0-eb4bec1f5e24"
>
</ReqRef><ReqRef
 Id="f9c0f0b7-0cba-4cee-ba0c-25c654215c74"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="31f6e0f4-13cb-4423-aa49-8e5cc06244e3"
>
</ReqRef><ReqRef
 Id="1103bf93-0534-41aa-a8dc-d09b48c38d5e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="817f8a25-2a9e-4216-996f-e29511f72419"
>
</ReqRef><ReqRef
 Id="51ee044c-b79a-4329-b477-4569763b65d1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1695a099-6939-439b-96f7-237c583278d8"
>
</ReqRef><ReqRef
 Id="2c111d3d-6708-48ec-ae52-2f2dd5ea8d7f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e671ada6-0189-46ee-907e-76d0bcb1fee6"
>
</ReqRef><Comment>Computes the value of A_safe for normal adhesion conditions with gradient 0.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="d"
 Guid="b3dbb352-f33b-46ea-a90a-bd92dc1095ee"
>
</Parameter><Parameter
 Type="BaseTypes.Speed"
 Name="V"
 Guid="3233c94f-0f10-451f-bc10-c796eb0e0f2b"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="22af61f1-eb6a-4c30-9475-b213da74018e"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="8c9d1ee0-0c94-488c-94f8-8d85df4b9e66"
>
<Expression>Kernel.TrackDescription.PermittedBrakingDistance.A_brake_safe (V) + Kernel.TrackDescription.PermittedBrakingDistance.A_gradient(Gradient)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Acceleration"
 Default=""
 X="340"
 Y="190"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="A_expected"
 Guid="5be61eb7-4d89-4255-92a2-d237529fc6fc"
>
<ReqRef
 Id="97a3e106-8336-4a99-8d77-cb4074e6882f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="225f2dcb-38b0-4ddb-b86f-8cab823e4c76"
>
</ReqRef><ReqRef
 Id="39f48aa1-5da9-45a4-8fc8-068260afeef8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="922bfecf-b9d2-433e-a658-a7071af0739c"
>
</ReqRef><ReqRef
 Id="60ba4e77-5948-4505-83fc-e13ee0244e31"
 SpecId="c238ead1-8ba7-4613-ae49-4288833ea80d"
 Guid="d58e3164-1270-4f65-9586-a38014535001"
>
</ReqRef><ReqRef
 Id="63f52c67-800b-450c-9dbc-7020eaf5e657"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3c29343e-3a35-4f16-a9e6-094e2c35b5d3"
>
</ReqRef><ReqRef
 Id="c7a43456-5326-4c4d-b89f-23b71a0240bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="50745557-31ba-426e-b407-63c7bf076b99"
>
</ReqRef><ReqRef
 Id="00117c31-ed13-4768-8e1a-ea0cc12ad9c6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="08d28fc4-035a-4de3-b9d3-54117e285c26"
>
</ReqRef><ReqRef
 Id="2c111d3d-6708-48ec-ae52-2f2dd5ea8d7f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ec423045-2fcf-46d0-9dd8-010f61123b7b"
>
</ReqRef><ReqRef
 Id="59b55377-5f37-4420-adf5-c0ce7ad42db1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="060c9648-b4b0-4d73-9e8b-5102e96f8462"
>
</ReqRef><Comment>Provides the value of the expected deceleration of the train, with gradient 0.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V"
 Guid="581285a2-d199-4610-a3df-8ec1d08eec82"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="ee6092e5-e433-4498-bf57-431f11c65b03"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="From train data"
 Guid="14a9304a-b95b-409c-9b90-ad4b590187ce"
>
<PreConditions>
<PreCondition
 Guid="59fd3e62-37f9-4040-ac3a-96214d7a24cf"
>TrainData.TrainData.Value.SBModels != EMPTY</PreCondition></PreConditions>
<Expression>TrainData.BrakingParameters.Default_brk_service (V) + Kernel.TrackDescription.PermittedBrakingDistance.A_gradient(Gradient)</Expression>
</Case><Case
 Name="From conversion model"
 Guid="40d171e2-7f71-49f1-9dbe-19e8a8faac39"
>
<PreConditions>
<PreCondition
 Guid="e650e13e-81be-4737-a404-293cace431a0"
>TrainData.BrakingParameters.ConversionModel.ConversionModelIsUsed()</PreCondition></PreConditions>
<Expression>Kernel.TrainData.BrakingParameters.ConversionModel.ServiceBrakes.A_brake_service ( V ) + Kernel.TrackDescription.PermittedBrakingDistance.A_gradient(Gradient)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="10"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="SpeedRestrictions"
 Guid="9a44a992-4b4e-4f13-a03c-45b2bad776b4"
>
<ReqRef
 Id="1be737d0-fb4e-4643-926f-c5fcada702d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="593829ba-4cb4-452e-89a5-b1cd65d8b4ab"
>
</ReqRef><ReqRef
 Id="c0212afe-50dc-4499-9f13-e6a734ef08fe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="61faa586-ed52-4515-8488-7a5ff1095682"
>
</ReqRef><ReqRef
 Id="5acdc9a4-5967-4a58-a3a7-1189b09139c7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c7703e6b-afab-4be7-ae9f-d868bd5f5bdc"
>
</ReqRef><ReqRef
 Id="5b9cb291-20b3-4b57-b985-9777f8e49ebc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ee9c2497-7075-4421-a8a2-3f1afdd876a7"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2aebae7b-fcea-46aa-8a04-4f5ca20dd56b"
>
</ReqRef><Comment>Provides the speed profile due to speed restrictions to ensure permitted braking distance.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="Distance"
 Guid="78111422-c910-44bf-8e2e-42bb5506c2b6"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="69bc209e-cb21-49a8-bd09-ea237265fca4"
>
<Expression>(REDUCE Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions 
    USING X IN  
        MIN ( First =&gt; FUNCTION d : Default.BaseTypes.Distance =&gt; Kernel.TrackDescription.PermittedBrakingDistance.PBDSpeedRestriction ( aSRPB =&gt; X, Distance =&gt; d ), 
                  Second =&gt; RESULT )
INITIAL_VALUE BaseTypes.MaxSpeedFunction ) (Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="450"
 Y="310"
 Width="100"
 Height="50"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="PBDSpeedRestriction"
 Guid="202025b4-0e31-4b35-9d1c-133892809155"
>
<Comment>Provides the speed restriction for a certain request to calculate a speed restriction which ensures that the train stops within a given permitted braking distance.</Comment>
<Parameters>
<Parameter
 Type="SRPBDStruct"
 Name="aSRPB"
 Guid="ada73484-df4f-465a-9111-63fb7a01cdf8"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="Distance"
 Guid="9642ec10-c6d1-4384-82e4-2424852c1b64"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="DuringPBD"
 Guid="4dbe7017-b850-406e-b2d1-9c938de73e3d"
>
<PreConditions>
<PreCondition
 Guid="627e8a19-828d-4a18-9e3f-669b7a2d8c63"
>Distance &lt; aSRPB.Location + BaseTypes.LengthToDistance ( aSRPB.Length )</PreCondition><PreCondition
 Guid="44c5bb4c-d995-4a71-8615-a3fef29ceac8"
>aSRPB.Location &lt;= Distance</PreCondition></PreConditions>
<Expression>aSRPB.Speed</Expression>
</Case><Case
 Name="BeyondPBD"
 Guid="3b543b4e-3f87-4250-9c13-93171f7655de"
>
<Expression>BaseTypes.Speed.MaxSpeed</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Acceleration"
 Default=""
 X="560"
 Y="190"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="A_gradient"
 Guid="ff4d8d35-9b13-45fd-b239-097d073ee88a"
>
<ReqRef
 Id="2c111d3d-6708-48ec-ae52-2f2dd5ea8d7f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="af76dc0f-3972-4bf4-9fcd-0f0190f31abe"
>
</ReqRef><Comment>Returns the acceleration due to the provided gradient, with compensation for nominal rotating mass</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="1c15b776-3692-4568-8037-92b0bd69109f"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="918992e5-ffd6-4a75-9604-fef457732318"
>
<Expression>BaseTypes.Acceleration.g * Kernel.TrackDescription.Gradient.CompensateGradientWithRotatingMass(Gradient)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Acceleration"
 Default=""
 X="450"
 Y="190"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="A_brake_safe"
 Guid="0cfdfadd-4ab2-467e-8f11-7a6d96a24894"
>
<ReqRef
 Id="597cfdc2-80f1-4a68-807f-b6173d958e91"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2441ef30-2fc9-43b2-b50d-57da11f33912"
>
</ReqRef><ReqRef
 Id="2a47f8ca-cb24-457f-98df-f582d87fc9f5"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e23f92a7-9c1e-491f-90af-c658503aca32"
>
</ReqRef><ReqRef
 Id="59212bdc-e7a1-4127-aa56-123c9f178c3f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b8932acf-4087-4dbc-b309-5ec04484fbb2"
>
</ReqRef><ReqRef
 Id="8cd1b370-4096-41a0-a4ba-709970b131cd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="55a7fb0e-5e85-48b3-be24-53d02c95b84c"
>
</ReqRef><ReqRef
 Id="09f9f219-2879-4eb9-bf75-c4583a632b4a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="82bb680c-4945-4f8b-aae0-2b56cff32d17"
>
</ReqRef><ReqRef
 Id="63f52c67-800b-450c-9dbc-7020eaf5e657"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0e84bbf4-7f97-4ce5-bb77-b761076b0a1c"
>
</ReqRef><ReqRef
 Id="1b7c34b0-8ee1-4615-9579-b4f183c85f6a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1ca053e1-5161-41fd-b336-e4a5d8e91700"
>
</ReqRef><ReqRef
 Id="d4abd686-74e0-4be7-8850-63b0d76f32da"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="75ee56bf-0155-459e-8192-aec1c85e880e"
>
</ReqRef><ReqRef
 Id="28e8fd74-8da8-4c8d-9d0b-2b3de6dea1ac"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b5965432-48d3-4bed-9057-83e0c8915de5"
>
</ReqRef><ReqRef
 Id="c688042e-0d6a-4705-82a5-db7cfe7b6840"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9bb1b998-c58b-4cb8-9704-1217af2f4e69"
>
</ReqRef><ReqRef
 Id="7cdec823-92bb-41e1-9c42-c852a448f5e8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f570be82-2b65-4074-a9ac-80ff3addc171"
>
</ReqRef><ReqRef
 Id="e6efd599-0613-4f01-8315-f611bcebacb5"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="35a8cd69-80f1-4b3f-8226-23349ee287bc"
>
</ReqRef><ReqRef
 Id="3dec5ab4-e034-4e35-8225-c22d5267e266"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e618201d-2624-473d-9689-a141d37e83ee"
>
</ReqRef><ReqRef
 Id="08b9f07e-b517-412e-8ea3-adc1aa89cba0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="26ae85e6-4f67-4bcb-be58-2e5a1d95b36d"
>
</ReqRef><Comment>Computes the safe emergency brake deceleration. Its value can be computed from the information provided by the Train Data or from the Conversion Model.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V"
 Guid="ee8bef9e-7b94-4b71-92d2-6b44883c63e6"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="From train data"
 Guid="e0b3c941-7132-4e86-bfc5-5663ee9cccf0"
>
<PreConditions>
<PreCondition
 Guid="aadc4768-d9d0-4121-ad97-03daa65b322c"
>TrainData.TrainData.Value.EBModels != EMPTY</PreCondition></PreConditions>
<Expression>TrainData.BrakingParameters.Kdry_rst (
    V =&gt; V,
    aM_NVEBCL =&gt; Kernel.NationalValues.CurrentNV().ConfLevelForEmergBrakeSafeDecelerationOnDryRails )
 * 
(TrainData.BrakingParameters.Kwet_rst ( V ) + Kernel.NationalValues.CurrentNV().WeightingFactorForAvailableWheelRailAdhesion * ( 1.0 - TrainData.BrakingParameters.Kwet_rst ( V ) ) )
 * 
TrainData.BrakingParameters.Default_brk_emergency(V)</Expression>
</Case><Case
 Name="From conversion model"
 Guid="23cbc22f-2c1a-405b-8152-7a44c441b6f3"
>
<PreConditions>
<PreCondition
 Guid="572e8bb1-06af-4554-aad8-8dee18cd6e36"
>TrainData.BrakingParameters.ConversionModel.ConversionModelIsUsed()</PreCondition></PreConditions>
<Expression>BaseTypes.Acceleration ( Kernel.NationalValues.Kv_int ( V ) * Kernel.NationalValues.Kr_int ( TrainData.TrainData.Value.TrainLength ) ) * Kernel.TrainData.BrakingParameters.ConversionModel.EmergencyBrakes.A_brake_emergency ( V )</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="340"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ComputePermittedSpeedForEB"
 Guid="028bde42-5ad5-41f6-9b88-0e89a78c86ac"
>
<ReqRef
 Id="6b0803c4-fc83-41dd-bcfd-d53de1634680"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="80964b20-08c9-4009-a19c-8d3d7610d418"
>
</ReqRef><ReqRef
 Id="ffb98aeb-e620-476c-8ca6-7b57a2bdf860"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="23a13d2c-01f5-40a4-bcba-4bd09e3b3502"
>
</ReqRef><ReqRef
 Id="256eb4d5-6af7-4f58-b1ad-b1fd498be1d7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0bfca987-4341-4d55-b787-66719b0dadc4"
>
</ReqRef><ReqRef
 Id="473066ff-b109-4dc9-bca2-85967286256b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="97760f4d-bd12-4889-adb4-215493373b5d"
>
</ReqRef><ReqRef
 Id="ed856630-b669-4f24-8abb-18ff6b70c623"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bbdadbd5-e6c6-4414-b341-4ab6771b511c"
>
</ReqRef><ReqRef
 Id="63a450f4-bf5b-4d7a-86d3-0d58f01de1b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="23150130-2fb3-41f7-9950-7b0d8dbeeed8"
>
</ReqRef><ReqRef
 Id="8c7db48b-2e9f-4028-9811-c07cc373b1cc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f01814c3-ba4f-4726-b883-3cab888e10cd"
>
</ReqRef><ReqRef
 Id="78901f0f-a70f-415d-8d57-e5156f7206d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f50a4f16-d5bc-4c92-b790-104dd0b801be"
>
</ReqRef><Comment>The inequalities (in linked requirements) can be interpreted as follows:

 - d_offset + D_bec &lt;= d_PBD
    d_offset and D_bed are two distances that increase as V_PBD increases. This can be understood as an upper limit on V_PBD.

 - ABS{(V_PBD + dV_ebi)-(V_EBD(d_offset + D_bec) - V_delta_0_PBD)} &lt;= 1km/h
    This can be understood that V_PBD+dV_ebi + V_delta_0_PBD = V_EBD(d_offset+D_bec)  more or less.


So we are looking for a value of V_PBD that satisfies the second eqation, while respecting the condition of the first.
Also, as d_offset+D_bec increases, V_PBD increases and V_EBD decreases.
If the first condition is not satisfied for V_PBD = 0, or if V_EBD is less than V_PBD for the smallest value of d_offset+D_bec, then there will be no solution to the second inequality and the function returns 0, otherwise we look for the value that solves the first inequality in equation form.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="d_PBD"
 Guid="0ffad4a2-4cae-4d59-942f-0a3e19c37a3c"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="189643af-1122-459e-ad10-b7dc07a80538"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="No value of V_PBD"
 Guid="ccdbce69-c640-4cca-821a-bf20da13645e"
>
<PreConditions>
<PreCondition
 Guid="4b011f3e-039d-4608-87c5-31a6c054e7b0"
>LET
dV &lt;- Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_ebi(0.0)

 IN
d_PBD &lt; Kernel.TrackDescription.PermittedBrakingDistance.Dbec( V_PBD =&gt; 0.0, dV =&gt; dV ) + Kernel.TrackDescription.PermittedBrakingDistance.d_offset( 0.0 + dV + Kernel.TrackDescription.PermittedBrakingDistance.Vdelta0PBD(0.0) )</PreCondition></PreConditions>
<Expression>0.0</Expression>
</Case><Case
 Name="Value"
 Guid="12794295-7bfd-46bf-9723-9e4e6a9a1553"
>
<Expression>LET
Target &lt;- TargetStruct{
    Location =&gt; TrainPosition.FrontEndPosition(DistanceIntervalEnum.Nom) + d_PBD,
    Speed =&gt; 0.0,
    Length =&gt; 0.0 }

 IN
STABILIZE
    V_PBDFunctionForEB_EB
    (
        V_previous =&gt; PREVIOUS,
        Gradient =&gt; Gradient,
        Target =&gt; Target
    )
INITIAL_VALUE
    Target.Speed
STOP_CONDITION
    BaseTypes.AbsoluteSpeed ( CURRENT - PREVIOUS ) &lt;= epsilon</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Distance"
 Default=""
 X="230"
 Y="310"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="d_offset"
 Guid="1c700673-b077-4da5-8b4b-1e34291b42c3"
>
<ReqRef
 Id="cc8e8e02-60fb-4417-9393-4dff7314e3ba"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0ef58d52-0884-4bc4-9062-50c389ea79f3"
>
</ReqRef><ReqRef
 Id="5d67617c-2424-460f-9d50-a7309f98b878"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="64296ff4-42cc-460c-ac43-3055630f14cc"
>
</ReqRef><Comment>Returns the offset between the train&apos;s antenna at the time the Balise was read and the front end position when the brakes are applied.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V"
 Guid="9f141ce0-217c-4265-a31b-a38d7aafbf63"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="29f39ba9-5eb5-4694-9943-ea36ad4f34ec"
>
<Expression>BTM.ActiveAntennaPosition + BaseTypes.SpeedToMS( V ) * Kernel.TrackDescription.PermittedBrakingDistance.T41</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="450"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="PermittedSpeedForSB_EB"
 Guid="93819934-9284-4345-85a6-8a8b99583937"
>
<ReqRef
 Id="487ecc36-819a-466e-927f-25b594c60f8f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2a8a0e1c-51c8-4ad1-b60c-71602b62810a"
>
</ReqRef><ReqRef
 Id="deacc74e-fbfb-47dd-b349-9315987b0dd1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e838c3a9-a31c-40c4-9226-5ea6b3a9f3d1"
>
</ReqRef><ReqRef
 Id="f4554793-dd91-466a-a509-694c2b4ae126"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="40bbd5fe-d582-4dff-a216-688fef3faa04"
>
</ReqRef><ReqRef
 Id="8c7db48b-2e9f-4028-9811-c07cc373b1cc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a0b9ca81-92d3-4773-ac22-6291c2583ebd"
>
</ReqRef><ReqRef
 Id="f4346f9e-2145-4af7-bd48-cf7b4dbaa3d6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e9a7f0b4-e8a4-4ab3-b97c-6617e57165f7"
>
</ReqRef><ReqRef
 Id="156a802d-6e3a-40b4-a563-5ed0e0e269cd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="be55b579-395d-480c-9c4d-858c1bb81230"
>
</ReqRef><ReqRef
 Id="cdc5e973-dc65-4303-890a-517186db0e7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="79458a21-b0b9-4c0b-8927-b59f383ed5d1"
>
</ReqRef><ReqRef
 Id="0c20dbe8-5365-4828-825d-2a5c1fc0168b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1d4c60e4-364c-4295-889a-8889f481e738"
>
</ReqRef><ReqRef
 Id="a4dbcf91-f014-4372-ad47-2cc7f9f411b3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="db2d29a5-685b-4232-9b95-df18b7508b63"
>
</ReqRef><ReqRef
 Id="fa888c61-602c-43d3-8f0f-cf5fa57f409a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a877ffeb-6cbd-4c6e-9184-050742c82c0f"
>
</ReqRef><ReqRef
 Id="5d67617c-2424-460f-9d50-a7309f98b878"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="49414851-6cf9-4c46-b6a2-a792445c4e05"
>
</ReqRef><ReqRef
 Id="193a1397-5f2b-4b18-b842-b525e8403c19"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4dc5d2e0-d56c-41bd-80c4-dcd446b7961e"
>
</ReqRef><Comment>See comment on ComputePermittedSpeedForEB for details of the calculation</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="d_PBD"
 Guid="9da7a53c-5268-40e3-bb24-b643ceec4b01"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="de89272a-1993-47f3-be2f-23b1462c95ff"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="No value"
 Guid="6e5febf3-a5a2-4054-a9c4-e3e99d6c0ecf"
>
<PreConditions>
<PreCondition
 Guid="aea8bb04-039b-4b1f-a151-48c43947693a"
>d_PBD &lt; Kernel.TrackDescription.PermittedBrakingDistance.d_offset( 0.0 + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(0.0) + Kernel.TrackDescription.PermittedBrakingDistance.Vdelta0PBD(0.0) ) + Kernel.TrackDescription.PermittedBrakingDistance.Dbec( V_PBD =&gt; 0.0, dV =&gt; Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(0.0) ) + ( 0.0 + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(0.0) )*Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.T_bs2</PreCondition></PreConditions>
<Expression>0.0</Expression>
</Case><Case
 Name="Value"
 Guid="ac3927ab-3f1b-484c-81ef-683b09ff8bb8"
>
<Expression>LET
Target &lt;- TargetStruct{
    Location =&gt; TrainPosition.FrontEndPosition(DistanceIntervalEnum.Nom) + d_PBD,
    Speed =&gt; 0.0,
    Length =&gt; 0.0 }

 IN
STABILIZE
    V_PBDFunctionForEB_SB(
        V_previous =&gt; PREVIOUS,
        Gradient =&gt; Gradient,
        Target =&gt; Target
    )
INITIAL_VALUE
    Target.Speed
STOP_CONDITION
    BaseTypes.AbsoluteSpeed ( CURRENT - PREVIOUS ) &lt;= epsilon</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="560"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="PermittedSpeedForSB_SB"
 Guid="bf02bffe-ca37-4cdf-8786-ba9f6842e6a4"
>
<ReqRef
 Id="9e7d4197-1c30-4b39-92cd-a636d43cd467"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="515cf44f-d39d-4a81-9630-9fd685c28a11"
>
</ReqRef><ReqRef
 Id="25263057-31b7-4226-b0de-0bec0c132acd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c9ca6021-efe7-4967-b8fd-68fd20f3c8dd"
>
</ReqRef><ReqRef
 Id="297da4a9-ce33-4638-bc80-e3abd77a4290"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b874942e-a23b-4e8e-af48-172e2c131405"
>
</ReqRef><ReqRef
 Id="bb553624-3428-4035-ae99-df4bea6282e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ea70f2a7-5ddf-4208-96a3-5d6405fc0f10"
>
</ReqRef><ReqRef
 Id="f4346f9e-2145-4af7-bd48-cf7b4dbaa3d6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="76c2df85-1110-4c19-9c0a-dc1c33cb7d89"
>
</ReqRef><ReqRef
 Id="93577eaa-8d60-44e6-95a3-acd9c3b352be"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="52e14a3d-10e1-4587-8559-cae464346302"
>
</ReqRef><ReqRef
 Id="449495a1-f9a0-42cc-ad9e-f524e9331789"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="005536cd-3375-4301-9305-8ca5c68c1b13"
>
</ReqRef><ReqRef
 Id="ecaef0c1-337e-4102-b161-13c39f7e619f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="12d82822-1612-4cb9-bc6a-931a9bd347b9"
>
</ReqRef><ReqRef
 Id="3f9b09ee-3df8-4f92-b36a-36d94b76f9dd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="62109576-41a2-48bb-b644-5fdde890ed48"
>
</ReqRef><ReqRef
 Id="669805bd-0d39-4992-b803-87fa5d6b2c44"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="85723fc3-8ec3-402f-9135-7b6166a9e0f8"
>
</ReqRef><ReqRef
 Id="6d439db1-f485-4c3a-bfc9-bcede4b4eab3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="563f0d86-8e40-4828-82a7-2da4bd36cb15"
>
</ReqRef><Comment>See comment on ComputePermittedSpeedForEB for details of the calculation</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="d8b06889-dda5-4233-946c-059f9f33780b"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="d_PBD"
 Guid="2b0023a7-6217-485f-879e-e19f0dbe65e1"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="No value"
 Guid="798055f5-0a01-4395-8c82-d24c2fa77c51"
>
<PreConditions>
<PreCondition
 Guid="68686248-6f3b-4bb5-91b3-6034c00fc553"
>d_PBD &lt; Kernel.TrackDescription.PermittedBrakingDistance.d_offset( 0.0 + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(0.0) ) + ( 0.0 + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(0.0) ) * Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.T_bs1</PreCondition></PreConditions>
<Expression>0.0</Expression>
</Case><Case
 Name="Value"
 Guid="8e7c458e-347b-42dd-a544-ef6a49849cd3"
>
<Expression>LET
Target &lt;- TargetStruct{
    Location =&gt; TrainPosition.FrontEndPosition(DistanceIntervalEnum.Nom) + d_PBD,
    Speed =&gt; 0.0,
    Length =&gt; 0.0 }

 IN
STABILIZE
    V_PBDFunctionForSB_SB(
        V_previous =&gt; PREVIOUS,
        Gradient =&gt; Gradient,
        Target =&gt; Target
    )
INITIAL_VALUE
    Target.Speed
STOP_CONDITION
    BaseTypes.AbsoluteSpeed ( CURRENT - PREVIOUS ) &lt;= epsilon</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="10"
 Y="370"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="V_PBDFunctionForEB_EB"
 Guid="e1afe3c9-3f15-435e-a51e-9923eb060731"
>
<ReqRef
 Id="6b0803c4-fc83-41dd-bcfd-d53de1634680"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f0f9cb4f-8226-4011-a11c-bb2935f3bbfb"
>
</ReqRef><ReqRef
 Id="ffb98aeb-e620-476c-8ca6-7b57a2bdf860"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="39c42848-4f38-4009-9e5d-b1328260e07a"
>
</ReqRef><ReqRef
 Id="142a3c74-1f88-416b-bcd7-7c7781199737"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7d25be71-8da2-41ed-a89d-67a811efef68"
>
</ReqRef><ReqRef
 Id="473066ff-b109-4dc9-bca2-85967286256b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="02314b2b-e043-434f-944c-1e8497f2b5aa"
>
</ReqRef><Comment>Iteratively calculates the value of V_PBD from the EBD curve</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V_previous"
 Guid="a28559f0-0dcb-4e89-98f6-ef3ea795c3d8"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="02142f39-90ff-4971-90b9-8dfad21c0a4f"
>
</Parameter><Parameter
 Type="TargetStruct"
 Name="Target"
 Guid="34388508-5ae0-4e57-856d-299d4b9c76ec"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="397b8239-33a2-46be-9332-726e4bc51b28"
>
<Expression>FullDecelerationForTarget (
    Target =&gt; Target,
    EndSpeed =&gt; 0.0,
    DecelerationFactor =&gt; FUNCTION d : BaseTypes.Distance, V : BaseTypes.Speed =&gt; Kernel.TrackDescription.PermittedBrakingDistance.A_safe( d =&gt; d, V =&gt; V, Gradient =&gt; Gradient )
)( Kernel.TrackDescription.PermittedBrakingDistance.d_offset(V_previous + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_ebi(V_previous)) + Kernel.TrackDescription.PermittedBrakingDistance.Dbec(V_PBD=&gt;V_previous, dV=&gt;Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_ebi(V_previous)) )
 - Kernel.TrackDescription.PermittedBrakingDistance.Vdelta0PBD(V_previous)</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="120"
 Y="370"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="V_PBDFunctionForSB_SB"
 Guid="0c246271-1243-4138-a903-832d18f9415c"
>
<ReqRef
 Id="9e7d4197-1c30-4b39-92cd-a636d43cd467"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="30f30b7a-5e7b-4243-85c0-ab6b83f46c2a"
>
</ReqRef><ReqRef
 Id="25263057-31b7-4226-b0de-0bec0c132acd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bf0f8d50-a50b-4f7e-a3c2-c797c886fb58"
>
</ReqRef><ReqRef
 Id="297da4a9-ce33-4638-bc80-e3abd77a4290"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b097533e-635c-462c-a2ea-859811c65687"
>
</ReqRef><Comment>Calculates V_PBD iteratively (for the SBD) in the case when it is to be achieved with the service brake</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V_previous"
 Guid="42b8f8bb-6b14-4ecb-9965-e1aba1c8e5cb"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="a5bd25f5-7aba-40a6-b71f-93db1e5aa804"
>
</Parameter><Parameter
 Type="TargetStruct"
 Name="Target"
 Guid="be31749f-27b0-46a0-b1a0-93f41514a29d"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="62e96d19-c1f0-4c40-9356-0052296487f6"
>
<Expression>FullDecelerationForTarget (
    Target =&gt; Target,
    EndSpeed =&gt; 0.0,
    DecelerationFactor =&gt; FUNCTION V : BaseTypes.Speed, d : BaseTypes.Distance =&gt; Kernel.TrackDescription.PermittedBrakingDistance.A_expected( V =&gt; V, Gradient =&gt; Gradient )
)( Kernel.TrackDescription.PermittedBrakingDistance.d_offset(V_previous + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(V_previous)) + ( V_previous + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(V_previous) ) * Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.T_bs1 )</Expression>
</Case></Cases>
</Function><Function
 Type="BaseTypes.Speed"
 Default=""
 X="230"
 Y="370"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="V_PBDFunctionForEB_SB"
 Guid="65795330-e340-4767-bf84-c4c661bd537d"
>
<ReqRef
 Id="487ecc36-819a-466e-927f-25b594c60f8f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8b82cf61-bcf5-4c8f-9546-06fa38437fcb"
>
</ReqRef><ReqRef
 Id="deacc74e-fbfb-47dd-b349-9315987b0dd1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8c44d84c-9c9b-4fb0-9b69-9d977027ae8f"
>
</ReqRef><ReqRef
 Id="f4554793-dd91-466a-a509-694c2b4ae126"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="49c2120a-d75e-4e8e-9cec-2327822348a6"
>
</ReqRef><ReqRef
 Id="fa888c61-602c-43d3-8f0f-cf5fa57f409a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="99c4d754-d6ac-4aee-98c6-e14c03eb8254"
>
</ReqRef><Comment>Calculates V_PBD iteratively (for the EBD) in the case when it is to be achieved with the service brake</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Speed"
 Name="V_previous"
 Guid="3d98fdd9-64a3-4b17-9205-ba0f5b28da50"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="3917eae1-23e9-479d-93d2-2a9f523468f9"
>
</Parameter><Parameter
 Type="TargetStruct"
 Name="Target"
 Guid="a668678f-6b7d-47f1-b52f-50578a38f84d"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="1e9d1e7a-6914-423f-88dc-aeebb2c97838"
>
<Expression>FullDecelerationForTarget (
    Target =&gt; Target,
    EndSpeed =&gt; 0.0,
    DecelerationFactor =&gt; FUNCTION d : BaseTypes.Distance, V : BaseTypes.Speed =&gt; Kernel.TrackDescription.PermittedBrakingDistance.A_safe( d =&gt; d, V =&gt; V, Gradient =&gt; Gradient )
)( Kernel.TrackDescription.PermittedBrakingDistance.d_offset(V_previous + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(V_previous)) + Kernel.TrackDescription.PermittedBrakingDistance.Dbec(V_PBD=&gt;V_previous, dV=&gt;Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(V_previous)) + BaseTypes.SpeedToMS(V_previous + Kernel.SpeedAndDistanceMonitoring.CeilingSpeedMonitoring.dV_sbi(V_previous))*Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.T_bs2 )
 - Kernel.TrackDescription.PermittedBrakingDistance.Vdelta0PBD(V_previous)</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 X="10"
 Y="460"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="PermittedBrakingDistanceProfileReceived"
 Guid="d4c0ee40-c93d-41e7-ac99-837086893c1a"
>
<ReqRef
 Id="0c087a57-86f8-4190-81b9-2698efc3cc18"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="807e0661-cab5-4902-bf68-0b2c988ef10e"
>
</ReqRef><ReqRef
 Id="18e66d36-7f79-47c5-92e4-d8b744a4513d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="18444086-46f2-4836-90c8-4f8077f347f8"
>
</ReqRef><ReqRef
 Id="9be8a6ae-9abe-4a16-8a19-f28a0581c994"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ba243b24-0daa-4d72-8eb7-54ef97442cfa"
>
</ReqRef><ReqRef
 Id="ffdc9150-a628-4750-a762-a41c20c3dd26"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ec555c69-4892-4154-ba52-1cdd7c4a26e9"
>
</ReqRef><ReqRef
 Id="1800bf83-b2c2-4d37-8406-ca0c31b30f0b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6d61cb18-75f3-46e6-86a9-68788bb3c0f4"
>
</ReqRef><ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f0f5c5b4-3b6e-488d-850c-22f4db9c4b99"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e8efeb9a-c5a9-4b99-84bd-82586aa7a649"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bd41934c-aaed-4f87-b4ee-b4d73db33829"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="520db918-bf9d-4c7b-9866-75cdd58b4d52"
>
</ReqRef><ReqRef
 Id="6c2271aa-b854-4ce6-ba1f-4892e06164b4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d9067be3-678b-4982-91fc-f11fe107779e"
>
</ReqRef><Comment>This procedure is called when a new speed restriction to ensure permitted braking distance is received. There are two cases:
  - If the initial states have to be resumed, the distance to where they have to be resumed is saved
  - If no initial states have to be resumed, the speed restriction profile is updated.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.PERMITTED_BRAKING_DISTANCE_INFORMATION.Message"
 Name="Packet"
 Guid="bf458dca-abb3-4313-a6e6-143c19b3a560"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="aDistanceFromRef"
 Guid="b6f65c8b-e83d-4e25-afab-5595f18be54a"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initial states to be resumed"
 Guid="8736371c-0de4-4e11-90f4-992afb4049e1"
>
<ReqRef
 Id="13a5ea24-0fd2-4281-99df-f3585e1e8e67"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="11d14b24-7e92-48d0-8546-17639f9f85c8"
>
</ReqRef><ReqRef
 Id="35ef498a-1c12-4203-b283-26436d281f11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="10705933-efb1-49f5-bb56-6c651f95a2c4"
>
</ReqRef><Comment>If the message states that there are initial states to be resumed, remove the profile starting from D_TRACKINIT</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initial states to be resumed"
 Guid="6727d13b-c821-4b71-a78f-8168f27bad89"
>
<PreConditions>
<PreCondition
 Guid="702c41be-b661-4a44-b0a3-9f3e6660c5a8"
>Packet.Q_TRACKINIT == Messages.Q_TRACKINIT.Empty_profile__initial_states_to_be_resumed</PreCondition><PreCondition
 Guid="c8150dfb-72db-4741-be81-ff85bc0005f8"
>Kernel.Mode != ModeEnum.TR</PreCondition></PreConditions>
<Actions>
<Action
 Guid="0f51ade6-1ab1-4d5e-a2e6-5ba1d3e16c12"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.InitialState &lt;- Packet.Q_TRACKINIT</Action><Action
 Guid="e9a968df-9178-43cc-b51e-4bee6b4e4d6f"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.EmptyProfileDistance &lt;- aDistanceFromRef + MessageTypes.QScaleDistance ( distance =&gt; Packet.D_TRACKINIT, scale =&gt; Packet.Q_SCALE)</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="No initial states to be resumed, remove old information"
 Guid="60476240-1db5-4e22-bcb0-ac7e15144c97"
>
<ReqRef
 Id="90d5e9cb-5620-45e8-a0aa-6018093e3100"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2249326a-57f6-4d63-98c6-3e269088a554"
>
</ReqRef><ReqRef
 Id="1cb531d4-2809-484c-bf3f-445bebb332ef"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4c2dc5d5-5b05-40bd-b3c8-073896896b80"
>
</ReqRef><Comment>If no initial states are to be resumed, remove the previously received information before adding the new speed restrictions</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="No initial states to be resumed, remove old information"
 Guid="a7ce0496-dee6-401b-b89e-fcd7547489f5"
>
<PreConditions>
<PreCondition
 Guid="ec6b53e9-a181-4239-8179-888b316dcb5c"
>Packet.Q_TRACKINIT == Messages.Q_TRACKINIT.No_initial_states_to_be_resumed__profile_to_follow</PreCondition><PreCondition
 Guid="30d32994-64d1-4b57-8f4b-d2cf299c84ad"
>Kernel.Mode != ModeEnum.TR</PreCondition></PreConditions>
<Actions>
<Action
 Guid="a2eaa572-8996-4e14-bb01-e726ed4ecfb1"
>REMOVE ALL X.Location &gt;= aDistanceFromRef + MessageTypes.QScaleDistance ( distance =&gt; Packet.D_PBDSR, scale =&gt; Packet.Q_SCALE ) IN SpeedRestrictionsProfile.SpeedRestrictions</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="No initial states to be resumed, insert new restrictions"
 Guid="fc4c76b7-b61c-4b82-b6d6-b2c135af5759"
>
<ReqRef
 Id="7286d7a7-e1e5-4269-ae7b-f3e6ff5a129f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="67aad431-7464-402f-b89e-dcddb88caf95"
>
</ReqRef><ReqRef
 Id="53a67aa1-ae7b-4091-a29f-1206dcc4e68c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="774d3460-2a84-4c21-a818-7f93f8f20d5e"
>
</ReqRef><ReqRef
 Id="295b2ae9-224d-4ce8-bc0a-a3be0c749a5f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cc1cc11f-21ed-4923-b664-a1e3f1f0def3"
>
</ReqRef><ReqRef
 Id="2bfc2474-36f9-4c5e-85b5-7a15a5ce1e4f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="feaae4b7-95c1-407d-bd62-fe4c67213e46"
>
</ReqRef><ReqRef
 Id="29875feb-36aa-465e-bbe9-34bae47c5b43"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="67976249-49d9-4892-9e0f-8d79f78465bb"
>
</ReqRef><ReqRef
 Id="be88793f-f209-4aef-b2ee-385ea2193212"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8102c187-84c0-480f-b14f-19377ca61467"
>
</ReqRef><Comment>Add the new restrictions to the list</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="No initial states to be resumed, insert new restrictions"
 Guid="95df77ae-90e8-4994-9927-fd2ef95e53c9"
>
<PreConditions>
<PreCondition
 Guid="4a1ce079-132b-43f6-8ba0-72284dca49b8"
>Packet.Q_TRACKINIT == Messages.Q_TRACKINIT.No_initial_states_to_be_resumed__profile_to_follow</PreCondition><PreCondition
 Guid="b67878e1-ff87-4b16-ade4-3944247f14da"
>Kernel.Mode != ModeEnum.TR</PreCondition></PreConditions>
<Actions>
<Action
 Guid="2afd30de-c39b-432c-9bcf-27501908073d"
>Kernel.TrackDescription.PermittedBrakingDistance.AddNewSpeedRestriction (
    Location =&gt; MessageTypes.QScaleDistance ( distance =&gt; Packet.D_PBDSR, scale =&gt; Packet.Q_SCALE ),
    Length =&gt; MessageTypes.QScaleLength ( length =&gt; Packet.L_PBDSR, scale =&gt; Packet.Q_SCALE ),
    PermittedBrakingDistance =&gt;  MessageTypes.QScaleDistance ( distance =&gt; Packet.D_PBD, scale =&gt; Packet.Q_SCALE ),
    Gradient =&gt; Kernel.TrackDescription.Gradient.CreateGradient ( Q_GDIR =&gt; Packet.Q_GDIR, G_A =&gt; Packet.G_PBDSR ),
    BrakeType =&gt; Packet.Q_PBDSR,
    aDistanceFromRef =&gt; aDistanceFromRef )</Action><Action
 Guid="4acb943c-c5f1-4bae-ac1d-9c276e643663"
>APPLY
    Kernel.TrackDescription.PermittedBrakingDistance.AddNewSpeedRestriction ( Location =&gt; MessageTypes.QScaleDistance ( distance =&gt; X.D_PBDSR, scale =&gt; Packet.Q_SCALE ),
                                                Length =&gt; MessageTypes.QScaleLength ( length =&gt; X.L_PBDSR, scale =&gt; Packet.Q_SCALE ),
                                                PermittedBrakingDistance =&gt;  MessageTypes.QScaleDistance ( distance =&gt; X.D_PBD, scale =&gt; Packet.Q_SCALE ),
                                                Gradient =&gt; Kernel.TrackDescription.Gradient.CreateGradient ( Q_GDIR =&gt; X.Q_GDIR, G_A =&gt;  X.G_PBDSR ),
                                                BrakeType =&gt; X.Q_PBDSR,
                                                aDistanceFromRef =&gt; aDistanceFromRef )
ON
    Packet.Sequence1</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Save inputs"
 Guid="fd009598-541a-43a3-97ef-193343e01593"
>
<ReqRef
 Id="1202840c-6fc7-4cd2-ae85-f73c589ab130"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a624c9c3-3940-48f5-bec7-bb0862f254ba"
>
</ReqRef><Comment>Save the inputs used in the calculations, so that they can be redone if any of this information changes</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Save inputs"
 Guid="560a969f-0f52-4a98-8134-98ff378d757a"
>
<PreConditions>
<PreCondition
 Guid="1bc57ee6-f129-4a6d-93c3-62b19efddc9c"
>Kernel.Mode != ModeEnum.TR</PreCondition></PreConditions>
<Actions>
<Action
 Guid="812f3ae6-01ea-41a2-9abe-58774618967b"
>Kernel.TrackDescription.PermittedBrakingDistance.PrevEBModels &lt;- TrainData.TrainData.Value.EBModels</Action><Action
 Guid="245ad180-10c2-4230-93e8-c5930841f91a"
>Kernel.TrackDescription.PermittedBrakingDistance.PrevSBModels &lt;- TrainData.TrainData.Value.SBModels</Action><Action
 Guid="06efd726-cf60-44b1-ba6a-733cf20e54d5"
>Kernel.TrackDescription.PermittedBrakingDistance.CompensationForSpeedInaccuracyInhibited &lt;- Kernel.NationalValues.CompensationOfInaccuracyOfTheSpeedIsInhibited()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="120"
 Y="460"
 Width="100"
 Height="50"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="AddNewSpeedRestriction"
 Guid="1435c9c3-63ee-4db5-80c9-c7f37e3a1614"
>
<ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="92449c2f-c6c8-4727-bc3d-3115817321b1"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="892208f1-50df-42dc-8ddf-922a8755d728"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="652609ad-b119-4337-92a9-8b52c9e06020"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b1ae5bba-5df3-469d-8aa7-8f14a912b46b"
>
</ReqRef><ReqRef
 Id="6c2271aa-b854-4ce6-ba1f-4892e06164b4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4db9e1cf-1887-4dba-a250-10d603d65696"
>
</ReqRef><Comment>Adds a new speed restriction to the speed restriction profile.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="Location"
 Guid="39537a4c-f5e3-4a14-a4c5-c6a17f8acfd2"
>
</Parameter><Parameter
 Type="BaseTypes.Length"
 Name="Length"
 Guid="dbc83436-90e5-4b67-9deb-f077f0efac48"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="PermittedBrakingDistance"
 Guid="5ee54604-5acc-4e67-be72-2db366245110"
>
</Parameter><Parameter
 Type="BaseTypes.Gradient"
 Name="Gradient"
 Guid="40b22e6d-6438-49d5-a9c5-f88099f19811"
>
</Parameter><Parameter
 Type="Messages.Q_PBDSR"
 Name="BrakeType"
 Guid="0197dd09-5e1a-4133-bc9a-02a2496b4c11"
>
</Parameter><Parameter
 Type="BaseTypes.Distance"
 Name="aDistanceFromRef"
 Guid="328d26be-324a-4685-a506-048334f891e6"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="InsertNewSpeedRestriction"
 Guid="5d7ec9d7-527d-4001-83cb-e2d5f5691e0c"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="InsertNewSpeedRestriction"
 Guid="0af0c7cd-07f4-4a57-b3ee-0cab6f3f2536"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="728d9949-d0ea-46e5-b08d-330bc6a880d3"
>INSERT Kernel.TrackDescription.PermittedBrakingDistance.CreateNewSpeedRestriction ( Location =&gt; Location, Length =&gt; Length, PermittedBrakingDistance =&gt; PermittedBrakingDistance, Gradient =&gt; Gradient, BrakeType =&gt; BrakeType, aDistanceFromRef =&gt; aDistanceFromRef )
IN Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="230"
 Y="460"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="UpdateSpeedRestriction"
 Guid="0260320b-5e34-491e-b4c8-2d3474395454"
>
<ReqRef
 Id="ac5b92fe-3181-4be2-be2c-0656928d153e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="51148404-10ab-4f54-87e0-2580ced2d56d"
>
</ReqRef><ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5bbf94a6-901e-45d8-a2f4-f426e69eae37"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="05ef46d5-2d04-4484-89d4-2cbcd056aaa0"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6f9b38e4-8da8-404d-9043-6906e8807c20"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="75aaf199-afe6-4652-803f-52fc58404f81"
>
</ReqRef><Comment>If any of the inputs for the calculation of the speed restrictions change, recalculate the speed restrictions due to permitted braking distances</Comment>
<Parameters>
<Parameter
 Type="SRPBDStruct"
 Name="aSRPB"
 Guid="3dcc62ba-b312-4a75-8474-65219553e4e0"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="UpdateSpeedRestriction"
 Guid="2be39405-c655-4024-8b03-bc83d80edea4"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="UpdateSpeedRestriction"
 Guid="00a4fb9f-c75a-43bd-ab25-2608ba8419f4"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="2c67d68f-ae9c-4923-a686-df47d174ae86"
>aSRPB.Speed &lt;- Kernel.TrackDescription.PermittedBrakingDistance.ComputePermittedSpeed ( PermittedBrakingDistance =&gt; aSRPB.BrakingDistance, Gradient =&gt; aSRPB.Gradient, BrakeType =&gt; aSRPB.BrakeType )</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 X="560"
 Y="310"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="DeletePBDProfileBeyondLocation"
 Guid="42e5f8a6-b0d4-4187-b7b7-a8923f5826d1"
>
<ReqRef
 Id="272fe976-efae-4c77-8efc-d232472a532b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f3ec381b-51f8-44d2-81a9-1a6bad616ca7"
>
</ReqRef><ReqRef
 Id="983096f7-b75d-42d2-be5a-fd2be9f8db6f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a692ca22-6837-4709-8dda-6d2e028968c9"
>
</ReqRef><ReqRef
 Id="8cd5d7d8-c20a-4927-9990-dacc4a577a3e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4dc8f36c-13a3-4068-ac25-24fd3d6a0f3f"
>
</ReqRef><ReqRef
 Id="69c41e0d-de0a-4c0e-9b6d-32a32fdf13e2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="df890dac-e7d3-40f3-95cf-d632102ec0a5"
>
</ReqRef><Comment>Deletes the PBD profile information beyond the provided location.</Comment>
<Parameters>
<Parameter
 Type="BaseTypes.Distance"
 Name="aLocation"
 Guid="4fae866a-ade5-47ab-b348-0f6a648243cf"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Delete PBD profile beyond the given location"
 Guid="cacbef1c-49cb-4295-b25d-58d0496c8400"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Delete PBD profile beyond the given location"
 Guid="3e621b35-02ef-480b-af74-8dfb9a9d63b7"
>
<PreConditions>
<PreCondition
 Guid="7e08dd15-4fbd-4e10-bf1b-b5518fa3be25"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions != []
  AND
(LAST X IN Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions).Location + (LAST X IN Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions).Length &gt; aLocation</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Remove elements beyond the given location"
 Guid="d09ac2fb-812f-45aa-a02b-9ef5e5d251aa"
>
<Comment>First, remove all the PBD elements that are beyond the provided location.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Remove elements beyond the given location"
 Guid="e440f7a1-214c-4094-b058-714f0e00b6ab"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="d074c1e7-493d-4cc0-8f90-e9a8ecd8bece"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions &lt;- MAP Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions | X.Location &lt;= aLocation USING X IN X</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Update the length of the last element"
 Guid="de1fed2c-e113-4064-badf-3a075449c76c"
>
<Comment>Then, update the length of the last PBD element in order for it to end at aLocation.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Update the length of the last element"
 Guid="4b68b186-b2b2-4e06-93a7-696d94aca789"
>
<PreConditions>
<PreCondition
 Guid="b074177f-4a78-4787-b2aa-ca5cb98bede6"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile != EMPTY
  AND
Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions != []</PreCondition></PreConditions>
<Actions>
<Action
 Guid="2a15c293-9048-4c8c-a66b-287ae23687cc"
>(LAST X IN Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions).Length &lt;- aLocation - (LAST X IN Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions).Location</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="SRPBDProfileStruct"
 DefaultValue="Kernel.TrackDescription.PermittedBrakingDistance.SRPBDProfileStruct
{
    InitialState =&gt; Messages.Q_TRACKINIT.No_initial_states_to_be_resumed__profile_to_follow, 
    EmptyProfileDistance =&gt; 0.0, 
    SpeedRestrictions =&gt; []
}"
 VariableMode="Internal"
 X="10"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="SpeedRestrictionsProfile"
 Guid="88028282-54cb-4064-b04a-227dc87f734f"
>
<ReqRef
 Id="c0212afe-50dc-4499-9f13-e6a734ef08fe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="470a1c10-9ac6-401c-a7a4-d1746fa66d1b"
>
</ReqRef><ReqRef
 Id="18e66d36-7f79-47c5-92e4-d8b744a4513d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="505f7ae7-1200-4b2b-9bc7-d5abd3537312"
>
</ReqRef><ReqRef
 Id="1b02a3e8-5313-4a1e-8209-c203e96ab40f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4e71541a-d993-4578-a7ea-5e286ad701c4"
>
</ReqRef><ReqRef
 Id="faca2edb-7220-4d55-bebe-f367d8f8d94a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a4dea454-0069-471f-a851-aeb09e9dc8f2"
>
</ReqRef><ReqRef
 Id="456d49d8-e372-4a93-b53b-700d92362a8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c389207f-2ed1-43fb-ab7f-108f22383ac1"
>
</ReqRef><ReqRef
 Id="209659eb-aa53-4a6d-a58e-491a42b89b61"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b630f2a7-7364-4e92-ad23-6f01f118ff96"
>
</ReqRef><ReqRef
 Id="3b4bfa4e-f425-4b5d-a82e-aaaf923dad11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ffcf7d7a-c296-450a-9d91-8c4247a968a1"
>
</ReqRef><ReqRef
 Id="c57326e0-6fe8-4373-825f-149a86761548"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bd08b84e-12ed-4191-a0f2-a26d330b56ae"
>
</ReqRef><Comment>Contains the speed restrictions due to permitted braking distance.</Comment>
</Variable><Variable
 Type="TrainData.BrakingParameters.EBModelSetStruct"
 DefaultValue="TrainData.BrakingParameters.EBModelSetStruct{}"
 VariableMode="Internal"
 X="340"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="PrevEBModels"
 Guid="d4118264-ae0f-46e1-a265-34e6d854d846"
>
<ReqRef
 Id="ac5b92fe-3181-4be2-be2c-0656928d153e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4fa2abef-34c5-48d2-b39c-3f85fd3f67fd"
>
</ReqRef><Comment>Contains the previous value of emergency braking models.</Comment>
</Variable><Variable
 Type="TrainData.BrakingParameters.SBModelSetStruct"
 DefaultValue="TrainData.BrakingParameters.SBModelSetStruct{}"
 VariableMode="Internal"
 X="450"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="PrevSBModels"
 Guid="d4f6207a-7599-4c13-bcb1-70c2869387fd"
>
<ReqRef
 Id="1202840c-6fc7-4cd2-ae85-f73c589ab130"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d6294354-7811-48c5-be20-e864ba83e49c"
>
</ReqRef><Comment>Contains the previous value of service braking models.</Comment>
</Variable><Variable
 Type="Boolean"
 DefaultValue=""
 VariableMode="Internal"
 X="560"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="CompensationForSpeedInaccuracyInhibited"
 Guid="840f756f-9723-4b11-907e-0c1097bc857c"
>
<ReqRef
 Id="603addf7-8a2f-4b2c-8e61-6c2de3f220f7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4906cb8e-f55d-4387-be2b-6932a4909206"
>
</ReqRef><ReqRef
 Id="7b334033-590c-4e04-b98a-1973062cc426"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1fa25baa-cb8d-4b62-9808-6bae48151906"
>
</ReqRef><Comment>Keeps the previous value of the National Value, Compensation for speed inaccuracy inhibited</Comment>
</Variable><Variable
 Type="BaseTypes.Time"
 DefaultValue="1.0"
 VariableMode="Internal"
 X="670"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="T41"
 Guid="04193745-0a02-4528-96f6-2a9e419ac68c"
>
<ReqRef
 Id="a17b6a33-29a8-4516-bde9-b715a3d3e84f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f7a8f249-05ba-4112-a2db-17fc8d5b9778"
>
</ReqRef><Comment>Delay between receiving a Balise message and applying the emergency brake.
Value provided by Subset-041, paragraph 5.2.1.1</Comment>
</Variable><Variable
 Type="BaseTypes.Speed"
 DefaultValue="1.0"
 VariableMode="Internal"
 X="780"
 Y="10"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="epsilon"
 Guid="53a639ef-9c0a-4807-9f1b-2a0895b1b08c"
>
<ReqRef
 Id="6b0803c4-fc83-41dd-bcfd-d53de1634680"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b64e7d47-1bec-4df4-bc2d-ceb489088657"
>
</ReqRef><ReqRef
 Id="deacc74e-fbfb-47dd-b349-9315987b0dd1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2216bb68-4c02-4989-b10e-b2adc56c1ac9"
>
</ReqRef><ReqRef
 Id="25263057-31b7-4226-b0de-0bec0c132acd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="78ea6c18-75e7-45df-998b-b9743b6e0cd5"
>
</ReqRef></Variable></Variables>
<Rules>
<Rule
 Priority="CleanUp"
 X="10"
 Y="540"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="Inputs for PBD change"
 Guid="eda7d7c2-6090-4a07-a068-b4f717a70e6d"
>
<ReqRef
 Id="ac5b92fe-3181-4be2-be2c-0656928d153e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bbabdeb7-7851-49a8-a317-290192b7767d"
>
</ReqRef><Comment>If the train brake characteristics change, the profile is updated.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Train brake characteristics change"
 Guid="62c68afa-4797-4cc2-b999-e0b345689ec5"
>
<Comment>If the train brake characteristics change, calculate the speed restrictions again</Comment>
<PreConditions>
<PreCondition
 Guid="87412dc3-a473-4513-ac75-4058b021c9b2"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile != EMPTY
  AND  
Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions != []</PreCondition><PreCondition
 Guid="9040d4f6-e334-4442-b2a9-d02e2978ab34"
>Kernel.TrackDescription.PermittedBrakingDistance.PrevEBModels != TrainData.TrainData.Value.EBModels
  OR  
Kernel.TrackDescription.PermittedBrakingDistance.PrevSBModels != TrainData.TrainData.Value.SBModels</PreCondition></PreConditions>
<Actions>
<Action
 Guid="1dcf7b2e-7a94-49c7-9f7e-7826aa500f44"
>APPLY
    Kernel.TrackDescription.PermittedBrakingDistance.UpdateSpeedRestriction ( X )
ON
    Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions</Action><Action
 Guid="e57ed655-74a3-4d58-acdf-6cde21486ad5"
>Kernel.TrackDescription.PermittedBrakingDistance.PrevSBModels &lt;- TrainData.TrainData.Value.SBModels</Action><Action
 Guid="89055dbd-938e-45d3-90a9-42cb151bc8f0"
>Kernel.TrackDescription.PermittedBrakingDistance.PrevEBModels &lt;- TrainData.TrainData.Value.EBModels</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="National Values, permission to compensate for inaccuracy of speed measurement changes"
 Guid="49d0bf0b-a292-4b4f-a962-5a29ccc702a7"
>
<Comment>If the relevant national value changes, calculate the speed restrictions again</Comment>
<PreConditions>
<PreCondition
 Guid="461c2817-11cd-48d1-9ce5-9884557cadb1"
>Kernel.NationalValues.CompensationOfInaccuracyOfTheSpeedIsInhibited() != Kernel.TrackDescription.PermittedBrakingDistance.CompensationForSpeedInaccuracyInhibited</PreCondition></PreConditions>
<Actions>
<Action
 Guid="3bc27eb9-4377-4dc1-bc29-4c8f376147bc"
>APPLY
    Kernel.TrackDescription.PermittedBrakingDistance.UpdateSpeedRestriction ( X )
ON
    Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions</Action><Action
 Guid="9fb8334a-ef20-46a7-915c-f404a81d6dce"
>Kernel.TrackDescription.PermittedBrakingDistance.CompensationForSpeedInaccuracyInhibited &lt;- Kernel.NationalValues.CompensationOfInaccuracyOfTheSpeedIsInhibited()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 X="120"
 Y="540"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="Resume initial states"
 Guid="ad604789-a2d8-405f-af6c-67eb3b68e03b"
>
<ReqRef
 Id="1be737d0-fb4e-4643-926f-c5fcada702d0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ab05174a-d8fd-4b73-8346-86a5130332f1"
>
</ReqRef><ReqRef
 Id="5acdc9a4-5967-4a58-a3a7-1189b09139c7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ed58a36b-7e32-4e7a-a5c4-4bb3067607ee"
>
</ReqRef><ReqRef
 Id="5b9cb291-20b3-4b57-b985-9777f8e49ebc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7a5c57c3-91d0-4faa-acc3-9c83364d08ba"
>
</ReqRef><ReqRef
 Id="13a5ea24-0fd2-4281-99df-f3585e1e8e67"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a867b46-8cec-460a-bd55-301e24e6de83"
>
</ReqRef><ReqRef
 Id="35ef498a-1c12-4203-b283-26436d281f11"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="058e9061-7076-4d8b-aff4-2d74e733802e"
>
</ReqRef><Comment>If the initial state has to be resumed and the target distance is reached, the profile is erased.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Resume initial states"
 Guid="3b923766-0772-4088-8ec2-7a1c3fb1cac6"
>
<PreConditions>
<PreCondition
 Guid="78be3145-3c25-4eee-8d51-da867970ffd2"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.InitialState == Messages.Q_TRACKINIT.Empty_profile__initial_states_to_be_resumed</PreCondition><PreCondition
 Guid="371ca729-718a-45bf-936c-877d3fa6dc55"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.EmptyProfileDistance &lt;= Kernel.TrainPosition.FrontEndPosition ( PointOfInterest =&gt; DistanceIntervalEnum.Nom )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="16926bd4-4cf4-4d72-a929-f1cf628266cb"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.SpeedRestrictions &lt;- []</Action><Action
 Guid="af776cb1-1756-4aea-871b-547067ee5c5e"
>Kernel.TrackDescription.PermittedBrakingDistance.SpeedRestrictionsProfile.InitialState &lt;- Messages.Q_TRACKINIT.No_initial_states_to_be_resumed__profile_to_follow</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</NameSpace>
