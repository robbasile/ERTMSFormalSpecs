<Frame
 CycleDuration="Kernel.CycleDuration"
 Name="Gradient"
 Guid="2e6a2ed5-f874-45f5-8739-9c28774cd5ad"
>
<SubSequences>
<SubSequence
 D_LRBG=""
 Level=""
 Mode=""
 NID_LRBG=""
 Q_DIRLRBG=""
 Q_DIRTRAIN=""
 Q_DLRBG=""
 RBC_ID=""
 RBCPhone=""
 Name="Receive gradient profile info"
 Guid="8b73f971-4e2f-43b0-8ed7-9dd647912492"
>
<TestCases>
<TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Compute gradient according to gradient profile message"
 Guid="ea0dbe13-f944-4c75-a784-bd5baa5da213"
>
<ReqRef
 Id="d96e7170-b578-4e28-bb03-82d0b7cc6a6d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ce73ee6c-c145-4233-b8c2-3c9db4d84c20"
>
</ReqRef><ReqRef
 Id="1a3c2b61-54c8-49b4-b142-4128f826e0d9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="58512f45-0a01-4adc-ba23-b3e82dbb5894"
>
</ReqRef><ReqRef
 Id="50b6b08d-a88c-4621-8123-19cf47ec3cf1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2fd9d330-28c5-4dc8-95be-ef3c909099b5"
>
</ReqRef><ReqRef
 Id="e0b809d3-897c-4378-98e7-67a5c3ae9468"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f4cc8517-a384-469d-9225-15be21dc8c11"
>
</ReqRef><ReqRef
 Id="e8393dfe-1151-4444-a62e-bf32f3cef6a2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8320cbf3-ddab-4d8e-b8ce-4b5b46de8527"
>
</ReqRef><ReqRef
 Id="6ed12ec2-277d-4e00-9838-d75deca5efae"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="689a1b47-b9dd-4a4e-8a27-f9ce96f0def4"
>
</ReqRef><ReqRef
 Id="748112e3-d318-4847-94da-e417e95dfa88"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bc52a4ff-fefc-4187-a3d0-1729b2c40232"
>
</ReqRef><ReqRef
 Id="58b032f9-8cd2-4fba-9fb7-862f6c37c470"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5e3bddbf-45d3-4512-acfc-f3d40421304b"
>
</ReqRef><ReqRef
 Id="5388dd34-33be-4b31-90c1-ec3bc653ccd4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7549ea8d-7f13-4c43-8e23-56b018e57a05"
>
</ReqRef><ReqRef
 Id="c8787b49-ee97-4460-b52b-1a690c6b12e2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0c263f6e-7cb2-4b1c-904f-4a91373d1155"
>
</ReqRef><ReqRef
 Id="79afcf7b-52b5-4eff-a6f8-5b6af8d6c1bc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="07aafa49-a76c-49e4-a719-9acb34789b50"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Initialize train data"
 Guid="2acaf0e5-a02c-4c6d-8d52-622c6939efe4"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="34a48d80-fc78-4938-99c9-d46cc12a5126"
>
<Actions>
<Action
 Guid="b4045215-437f-4317-8b27-9b3ddbc80253"
>Testing.InitializeTestEnvironment
(
    aTrainPosition =&gt; 100.0,
    aMode =&gt; ModeEnum.SR
)</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Setup"
 Guid="f97de7a3-844b-4651-bfd1-1f11c3915e15"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="4b629e04-2a80-4cd3-bdcb-a15f9cb2e986"
>
<Actions>
<Action
 Guid="011b3646-08a8-4b4b-adc0-cf4ba52fea06"
>Kernel.TrackDescription.Gradient.DefaultGradientForTSR &lt;- EMPTY</Action><Action
 Guid="db4021c1-a501-404d-b720-7d6a757ed1a5"
>Kernel.TrackDescription.Gradient.Gradients &lt;- []</Action><Action
 Guid="853f8842-f3ba-41f1-a2bc-72216b657fef"
>Kernel.TrainData.TrainData.Value.M_rotating_nom &lt;- 5.0</Action><Action
 Guid="dddd56df-c0d2-40f7-81c1-0f32b14d8104"
>INSERT BTM.LRBG.PreviousBaliseGroupStruct{
    BaliseGroup =&gt; BTM.LRBG.BaliseGroupStruct{
  NID_BG=&gt;9616,
  Orientation=&gt;OrientationEnum.Nominal,
  Position=&gt;BTM.PositionStruct{
    OverReadingAmountOdo =&gt; 0.0,
    Position =&gt; 4000.0,
    UnderReadingAmountOdo =&gt; 0.0
  }
},
    IsLRBG =&gt; True,
    IsSingle =&gt; False
}

 IN BTM.LRBG.PreviousBaliseGroups</Action><Action
 Guid="b3ceed3e-10fd-44d2-8244-442969f18f37"
>Kernel.TrainData.TrainData.Value.TrainLength &lt;- 100.0</Action><Action
 Guid="244132c9-abab-4ab2-af2f-8ec46b19189b"
>Kernel.TrainData.TrainData.DataState &lt;- DataStateEnum.Valid</Action><Action
 Guid="fc29eb32-ad70-4d95-b74a-1f88f165ec6d"
>Odometry.EstimatedSpeed &lt;- 40.0</Action><Action
 Guid="f2dbdcd5-36d5-40f0-8e40-9400ecbaf3a0"
>Kernel.Level.Value.Value &lt;- LevelEnum.L1</Action><Action
 Guid="806dac37-d400-49f6-9a79-8112a9d5f136"
>Odometry.NominalDistance &lt;- 4105.0</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive gradient profile"
 Guid="b83a85a8-b10b-47fd-b307-cc3d7ba2ab93"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="719acfde-43d9-497a-8142-23557b3c9c9f"
>
<Actions>
<Action
 Guid="8f625a88-5fab-4b6e-b66a-edb88847b7cb"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;[]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2 - Message"
 Guid="fb3b4c26-1f3d-4170-8b96-60c2f8907b72"
>
<Actions>
<Action
 Guid="921edf6d-c661-40b7-83fa-b7c460445313"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 4000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 2,
                    N_ITER =&gt; 3,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 2000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 1
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 4
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 5000,
                        Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                        G_A =&gt; 255
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="9cc2a57d-541f-4ffa-87fe-b90a13da07bc"
>( THERE_IS X IN Kernel.TrackDescription.Gradient.Gradients | X.Location == 4100.0 )</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Check first element in the gradient structure"
 Guid="00d95138-88ea-424c-a399-e2def25e89c1"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="0a65249f-f323-4404-95c3-b2c120cbaf56"
>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="93d1b55e-8e1b-4383-9ab6-1190f0c45e9b"
>Kernel.TrackDescription.Gradient.GradientEnd ( 
  Current =&gt; FIRST X IN Kernel.TrackDescription.Gradient.Gradients | X.Location == 4100.0 
) == 6100.0</Expectation><Expectation
 Kind="Instantaneous"
 Guid="8d5e3344-3819-4400-8a33-003150adeed3"
>Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  FIRST X IN Kernel.TrackDescription.Gradient.Gradients | X.Location == 4100.0,
  Distance =&gt; 7000.0
) == BaseTypes.Gradient.Indefinite</Expectation><Expectation
 Kind="Instantaneous"
 Guid="a5d28ba0-a7c8-411e-9b21-c7a6fc399990"
>Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  FIRST X IN Kernel.TrackDescription.Gradient.Gradients | X.Location == 4100.0,
  Distance =&gt; 5000.0
) &lt; 0.002 
AND
Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  FIRST X IN Kernel.TrackDescription.Gradient.Gradients | X.Location == 4100.0,
  Distance =&gt; 5000.0
) &gt; 0.0018</Expectation><Expectation
 Kind="Instantaneous"
 Guid="9b4217f9-7059-4ad1-b8a9-d8b1fe6f4d7e"
>Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  FIRST X IN Kernel.TrackDescription.Gradient.Gradients | X.Location == 4100.0,
  Distance =&gt; 3000.0
) == BaseTypes.Gradient.Indefinite</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Check last element in the gradient structure"
 Guid="a5f55376-0a88-42e0-89c6-af2691814342"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="3584d226-bab2-435d-90c9-24ab343715ff"
>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="1d070dfa-e211-4c91-9024-dddd162bcc76"
>Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  LAST X IN Kernel.TrackDescription.Gradient.Gradients,
  Distance =&gt; 20000.0
) == BaseTypes.Gradient.Indefinite</Expectation><Expectation
 Kind="Instantaneous"
 Guid="b27318c5-9ac4-4bb1-9475-00117e663e02"
>Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  LAST X IN Kernel.TrackDescription.Gradient.Gradients,
  Distance =&gt; 12100.0
) == BaseTypes.Gradient.Indefinite</Expectation><Expectation
 Kind="Instantaneous"
 Guid="3197224b-c79c-4ba1-8102-43600861888c"
>Kernel.TrackDescription.Gradient.GradientInfoProfile (
  GradientInfo =&gt;  LAST X IN Kernel.TrackDescription.Gradient.Gradients,
  Distance =&gt; 11000.0
) == BaseTypes.Gradient.Indefinite</Expectation><Expectation
 Kind="Instantaneous"
 Guid="61ef0c7c-1423-4b27-8104-ccb644dd6106"
>Kernel.TrackDescription.Gradient.GradientEnd ( 
  Current =&gt; LAST X IN Kernel.TrackDescription.Gradient.Gradients
) == 12100.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Check gradient profile function"
 Guid="1882d7be-3fc4-4a66-bb55-0155675080ac"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="136f2021-7f0e-4793-adc4-cc12e92d750a"
>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="e5edeec8-b615-4211-bb19-390eaccb1e77"
>Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 4099.0 ) == 0.0</Expectation><Expectation
 Kind="Instantaneous"
 Guid="4a75f342-d2c3-41d1-9c00-abb6fe00f521"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 4100.0 ) &lt; 0.002 ) AND
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 4100.0 ) &gt; 0.0018 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="a2dc9101-c683-475d-80b0-d1371adec17d"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 6099.0 ) &lt; 0.002 ) AND
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 6099.0 ) &gt; 0.0018 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="c3894549-1ead-4e96-8088-edf556da77a4"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 6100.0 ) &gt; -0.001 ) AND
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 6100.0 ) &lt; -0.0009 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="530f2959-1e82-46d9-896c-8b8f63ffafec"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 7099.0 ) &gt; -0.001 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 7099.0 ) &lt; -0.0009 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="b021ea68-435c-4d32-b68d-2ab8cd14b8ac"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 7100.0 ) &gt; -0.004 ) AND
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 7100.0 ) &lt; -0.0036 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="890b9f1d-c6b9-48a9-b112-f6411db5d115"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 12099.0 ) &gt; -0.004 ) AND
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 12099.0 ) &lt; -0.0036 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="beb5eee2-ec1d-48f2-9a17-598fb3a9597b"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; Kernel.TrackDescription.Gradient.GradientEnd ( 
  Current =&gt; LAST X IN Kernel.TrackDescription.Gradient.Gradients
) + BaseTypes.LengthToDistance(Kernel.TrainData.TrainData.Value.TrainLength)) ) == 0.0</Expectation><Expectation
 Kind="Instantaneous"
 Guid="b14b16a7-aee4-4b1d-a29b-cf7200ccca5c"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 16000.0 ) ) == 0.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive new gradient profile"
 Guid="936dfea8-af8c-4b84-9a46-6bd1660c57e5"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="750822d0-8e2e-4678-af49-42433d20f89b"
>
<Actions>
<Action
 Guid="b980a387-f018-4175-b6c8-cdbb5bb5f611"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2126,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 5000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 3,
                    N_ITER =&gt; 2,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 4000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 2
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 2000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 255
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2"
 Guid="2a8f922a-6de2-4d3a-b4d0-f8baa9f363e9"
>
<Actions>
<Action
 Guid="204d4adb-37ef-4293-be8f-2042af38adaf"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2126,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;[]
}</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Check gradient profile function"
 Guid="7c8fa95f-87ac-411c-8eee-8a33ae8efa71"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="a3f2523b-5c84-4b39-afb2-2aa1782e69a2"
>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="b9396ef7-2602-4b54-b68e-8d47bf640c80"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 5200.0 ) &lt; 0.003 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 5200.0 ) &gt; 0.0027 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="b16d6a9d-22d8-44ab-996b-1d6abf2a079b"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 5199.0 ) &lt; 0.002 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 5199.0 ) &gt; 0.0018 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="cfcaf736-89fd-4474-bc1d-7ec78e5cc81c"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 4100.0 ) &lt; 0.002 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 4100.0 ) &gt; 0.0018 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="b82675d8-81f5-4059-8a19-aa5c9881689c"
>Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 4099.0 ) == 0.0</Expectation><Expectation
 Kind="Instantaneous"
 Guid="73c74257-e22c-463b-9389-6b426b31f1a3"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 9099.0 ) &lt; 0.003 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 9099.0 ) &gt; 0.0027 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="8c4279d0-7ccf-4b11-bc30-041e776abcd3"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 9100.0 ) &gt; -0.002 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 9100.0 ) &lt; -0.0018 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="c60ccd42-a9cc-4b58-8fa4-2dc9c70d6176"
>( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 11199.0 ) &gt; -0.002 ) AND 
( Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 11199.0 ) &lt; -0.0018 )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="996be7bf-e2a5-4929-b71c-1c86ec23fad1"
>Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 16000.0 ) == 0.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase></TestCases>
</SubSequence><SubSequence
 D_LRBG=""
 Level=""
 Mode=""
 NID_LRBG=""
 Q_DIRLRBG=""
 Q_DIRTRAIN=""
 Q_DLRBG=""
 RBC_ID=""
 RBCPhone=""
 Name="Receive TSR gradient information"
 Guid="0f130567-08e8-4fa2-8e8f-0ad8398ec756"
>
<TestCases>
<TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Setup"
 Guid="ee6ed04e-7bbb-445b-979b-642b952b6583"
>
<ReqRef
 Id="02d9f252-59e9-4dbb-a7cc-b66f2b96fe25"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d8f9c14f-20e7-4c80-a162-fe9dc5e8ee23"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Initialize train data"
 Guid="b7a970c6-6994-44d0-9439-e81571ee027e"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="3af3a935-7705-41ab-a4ee-4e3c4b631a5f"
>
<Actions>
<Action
 Guid="fc21e6d2-27da-419d-883c-f22a8128a51e"
>Testing.InitializeTestEnvironment
(
    aTrainPosition =&gt; 100.0,
    aMode =&gt; ModeEnum.FS
)</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Setup train data"
 Guid="c0a7b940-8cec-4f5d-b5d8-dcfe0f9473aa"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="502f5501-54e5-4bed-bfd1-f1afa766b490"
>
<Actions>
<Action
 Guid="a1f841ef-1b47-49f4-8fbf-fa3bef52d1eb"
>INSERT BTM.LRBG.PreviousBaliseGroupStruct{
    BaliseGroup =&gt; BTM.LRBG.BaliseGroupStruct{
  NID_BG=&gt;2123,
  Orientation=&gt;OrientationEnum.Nominal,
  Position=&gt;BTM.PositionStruct{
    OverReadingAmountOdo=&gt;19.0,
    Position=&gt;17000.0,
    UnderReadingAmountOdo=&gt;18.0
  }
},
    IsLRBG =&gt; True,
    IsSingle =&gt; False
}

 IN BTM.LRBG.PreviousBaliseGroups</Action><Action
 Guid="8c106c5c-a6d9-4eab-869c-42cdb117b297"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked
}</Action><Action
 Guid="7da317b9-61f9-4495-994f-16301155ab69"
>Odometry.NominalDistance &lt;- 20000.0</Action><Action
 Guid="6cbdf75d-75a8-4da6-805a-9102e16ff638"
>Kernel.TSR.TSRs &lt;- []</Action><Action
 Guid="74dab5ed-ba59-4e0c-ad5b-28aa14438844"
>Kernel.TrainData.TrainData.Value.M_rotating_nom &lt;- 5.0</Action><Action
 Guid="3391e64f-34b6-4c81-997a-4d652530b71f"
>Kernel.TrackDescription.Gradient.Gradients &lt;- []</Action><Action
 Guid="681ce237-b8ca-40f6-b2c1-e23d144546eb"
>Kernel.TrackDescription.Gradient.DefaultGradientForTSR &lt;- EMPTY</Action><Action
 Guid="a5b53f69-ea55-4896-9384-37f369423630"
>Odometry.Accuracy &lt;- Odometry.OdometerAccuracyStruct
{
    D_ura =&gt; 28.0,
    D_ora =&gt; 21.0,
    V_ora =&gt; 0.0,
    V_ura =&gt; 0.0
}</Action><Action
 Guid="4345a154-1e65-49b1-98e5-4f81e9cecd5c"
>Kernel.TrainData.TrainData.Value.TrainLength &lt;- 100.0</Action><Action
 Guid="6ce8cd14-9a77-4abe-b9be-d0f2f75e75e1"
>Kernel.Level.Value.Value &lt;- LevelEnum.L1</Action><Action
 Guid="c889a0eb-809b-4d3d-b9c0-73d25b2141d5"
>Kernel.TrainData.TrainData.DataState &lt;- DataStateEnum.Valid</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive gradient profile for temporary speed restriction"
 Guid="a853a3c5-ae16-4106-b585-3909331c40f2"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="45516ac3-a9e9-4568-9021-bfca04702a30"
>
<Actions>
<Action
 Guid="7d356861-95a7-4035-8d3a-c02e9e5f7f6b"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                DEFAULT_GRADIENT_FOR_TEMPORARY_SPEED_RESTRICTION =&gt; Messages.PACKET.TRACK_TO_TRAIN.DEFAULT_GRADIENT_FOR_TEMPORARY_SPEED_RESTRICTION.Message
                {
                    NID_PACKET=&gt;141,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                    G_TSR =&gt; 30
               }
            }
        }
    ]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="6e494873-e675-4e6c-b5e5-b2bd8dbfed7f"
>Available ( Kernel.TrackDescription.Gradient.DefaultGradientForTSR )</Expectation><Expectation
 Kind="Instantaneous"
 Guid="b37c088a-c9f2-4337-b102-c1ac4d88c9e9"
>Kernel.TrackDescription.Gradient.DefaultGradientForTSR.Gradient == -30.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Check gradient profile function"
 Guid="94dc1944-31f2-487d-b44c-7297ed1c2b62"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="39fc8fa3-4fb4-4836-95fe-8af7ea62a14b"
>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="b87340bd-9856-4cad-b0b6-b6afcb8a800e"
>Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 1000.0 ) == 0.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase><TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Provide a TSR"
 Guid="c5347a16-1c43-4d15-aada-68b4b1d0b6f7"
>
<ReqRef
 Id="5388dd34-33be-4b31-90c1-ec3bc653ccd4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="54327b67-6365-4ff6-b6d9-160042a4f49c"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Keep the train orientation without linking"
 Guid="f7065416-e030-457b-9927-6eb832cfce09"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="c821d241-c472-45b6-a50a-ef8761bd7875"
>
<Actions>
<Action
 Guid="b2d89c26-edcd-4f71-b72f-1eb70dcc570a"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked
}</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="provide a TSR"
 Guid="ceeb0840-6965-4b87-92ab-08e481954705"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="39bae75d-9b80-4247-8547-85be68c0ace7"
>
<Actions>
<Action
 Guid="96499e6e-f9ee-41c0-b0b1-f1a19a6d56c3"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                TEMPORARY_SPEED_RESTRICTION =&gt; Messages.PACKET.TRACK_TO_TRAIN.TEMPORARY_SPEED_RESTRICTION.Message
                {
                    NID_PACKET=&gt;8,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_TSR =&gt; 4000,
                    L_TSR =&gt; 1500,
                    NID_TSR =&gt; 1515,
                    Q_FRONT =&gt; Messages.Q_FRONT.No_train_length_delay_on_validity_end_point_of_profile_element ,
                    V_TSR =&gt; 5
                }
            }
        }
    ]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="d597eaed-d598-47c3-9e35-8c172d220d58"
>Kernel.TSR.CurrentTargetDueToTSR()</Expectation><Expectation
 Kind="Instantaneous"
 Guid="31ce7c65-fd3d-4192-b242-12072ebc41fd"
>Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 1000.0 ) == -30.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase><TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Provide a new TSR gradient information"
 Guid="faba4eaa-eada-43f7-9d5f-d4279b7ae8c6"
>
<ReqRef
 Id="ca53e2c7-6148-4023-8a27-3d8b94de964c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2699918b-9866-42c9-a4ac-6a153192375c"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Setup gradient profile for temporary speed restriction"
 Guid="221b9cfa-9cd8-49bd-b8eb-0e6213b37ed6"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="1bd508b6-70a6-450e-81c9-4c4582746d59"
>
<Actions>
<Action
 Guid="303d305b-845e-4ea3-9a6c-3f2ce78c1270"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2126,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;[]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2"
 Guid="53bf45d7-1ef8-42b4-b99c-c170d8a9dece"
>
<Actions>
<Action
 Guid="7f46cfd8-f083-44a5-aeed-44dcc4ee1625"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2126,
    Q_LINK=&gt;Messages.Q_LINK.Unlinked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                DEFAULT_GRADIENT_FOR_TEMPORARY_SPEED_RESTRICTION =&gt; Messages.PACKET.TRACK_TO_TRAIN.DEFAULT_GRADIENT_FOR_TEMPORARY_SPEED_RESTRICTION.Message
                {
                    NID_PACKET=&gt;141,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                    G_TSR =&gt; 40
               }
            }
        }
    ]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="1b57a19f-99e9-4701-b8ac-7eef22837da5"
>Kernel.TrackDescription.Gradient.GradientProfile ( Distance =&gt; 1000.0 ) == -40.0</Expectation><Expectation
 Kind="Instantaneous"
 Guid="a673d41d-6e86-4e9c-9883-07181e26492a"
>Kernel.TrackDescription.Gradient.DefaultGradientForTSR.Gradient == -40.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase></TestCases>
</SubSequence><SubSequence
 D_LRBG=""
 Level=""
 Mode=""
 NID_LRBG=""
 Q_DIRLRBG=""
 Q_DIRTRAIN=""
 Q_DLRBG=""
 RBC_ID=""
 RBCPhone=""
 Name="Replace existing gradient information"
 Guid="bf84f1e8-97b8-4661-a3d8-c1b61bb2682f"
>
<TestCases>
<TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 Name="Test case1 - Partial replacement"
 Guid="cd2ec351-bfea-44e2-b1ab-22d37bfec678"
>
<ReqRef
 Id="d8ccf575-2703-40a1-8aac-bf3fe6714fd5"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="72149986-df9b-4de0-96f5-17f971988199"
>
</ReqRef><ReqRef
 Id="65fe6091-380a-44f6-8b7e-27202620ae3d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6fdbe7b9-7bb6-46b5-b0d4-84e042726668"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Initialize train data"
 Guid="92cad856-3dc1-4159-9768-3177294840af"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="a12d494d-2bd6-4532-8ef3-1c2e7c667892"
>
<Actions>
<Action
 Guid="2f86b70b-fbd4-400e-8249-2c4af424c3cf"
>Testing.InitializeTestEnvironment
(
    aTrainPosition =&gt; 100.0,
    aMode =&gt; ModeEnum.SR
)</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Setup"
 Guid="1b0fadc2-326b-4e04-9422-dbcbcc3707fb"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="048dc5ff-2e9a-43f4-8739-ee79a76589a9"
>
<Actions>
<Action
 Guid="99b2fb5e-42cf-4cc9-91d9-e2a05af432a2"
>Kernel.TrackDescription.Gradient.Gradients &lt;- []</Action><Action
 Guid="d86cece9-de86-4de2-9b4e-2556cc7a0bc6"
>INSERT BTM.LRBG.PreviousBaliseGroupStruct{
    BaliseGroup =&gt; BTM.LRBG.BaliseGroupStruct{
  NID_BG=&gt; 9616,
  Orientation=&gt; OrientationEnum.Nominal,
  Timestamp =&gt; Kernel.DateAndTime.Now(),
  Position=&gt; BTM.PositionStruct{
    OverReadingAmountOdo =&gt; 0.0,
    Position =&gt; 4000.0,
    UnderReadingAmountOdo =&gt; 0.0
  }
},
    IsLRBG =&gt; True,
    IsSingle =&gt; False
}

 IN BTM.LRBG.PreviousBaliseGroups</Action><Action
 Guid="71584a08-9d51-4078-8aae-11fb3807b069"
>BTM.Linking.Linkings &lt;- [BTM.Linking.LinkingDataStruct{
    LocationAccuracy =&gt; 5.0,
    Orientation =&gt; OrientationEnum.Nominal,
    Reaction =&gt; BTM.Linking.LinkingReaction.NoReaction,
    Distance =&gt; 200.0,
    BaliseGroupIdentifier =&gt; 2124
},BTM.Linking.LinkingDataStruct{
    LocationAccuracy =&gt; 5.0,
    Orientation =&gt; OrientationEnum.Nominal,
    Reaction =&gt; BTM.Linking.LinkingReaction.NoReaction,
    Distance =&gt; 0.0,
    BaliseGroupIdentifier =&gt; 2125
}]</Action><Action
 Guid="6c15cf15-c9c0-477d-9287-0fa89d93a264"
>Odometry.NominalDistance &lt;- 4200.0</Action><Action
 Guid="e1902deb-5489-47dd-8036-ab825e7ecd14"
>Odometry.EstimatedSpeed &lt;- 40.0</Action><Action
 Guid="9d3f77b7-bac8-443e-a726-14d12a6aabdb"
>Kernel.Level.Value.Value &lt;- LevelEnum.L1</Action><Action
 Guid="c302fae2-e3c1-4010-b005-99f7d493b446"
>Kernel.TrainData.TrainData.DataState &lt;- DataStateEnum.Valid</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive gradient profile"
 Guid="e0a3b794-54c0-4cfe-8b3d-32292212ce96"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="116d1a35-3946-4807-b5f7-1b78e50b7055"
>
<Actions>
<Action
 Guid="d71e80dc-2c52-4f91-bea2-62f0aa7eb28c"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 4000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 2,
                    N_ITER =&gt; 3,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 2000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 1
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 4
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 5000,
                        Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                        G_A =&gt; 255
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2"
 Guid="1f21caea-2690-461b-92b4-0229b9a48905"
>
<Actions>
<Action
 Guid="79c50b6d-123b-4a82-8666-0848f6e6d4b4"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;[]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="40a8d5c9-d65a-46e6-b589-816cc4615cd4"
>(COUNT X IN Kernel.TrackDescription.Gradient.Gradients) == 4</Expectation><Expectation
 Kind="Instantaneous"
 Guid="f9504af3-17d7-44c2-b759-30491841a57e"
>(FIRST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 4000.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="fa76dcac-72b8-4cc1-8773-a665fcbaa512"
>(LAST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 12000.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive new gradient profile with partial overwriting"
 Guid="ff593467-25dd-4d19-a775-cc0e07260625"
>
<Comment>Keep in mind: D_Gradient is an incemental value -- but Kernel.TrackDescription.Gradient.GradientInfo.Location holds an absolute value.</Comment>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="4aac2ce4-0a81-4f6d-9b6d-aaa2c5c2fc86"
>
<Actions>
<Action
 Guid="6238e8cc-1635-4b14-87cb-e09be1aa303f"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 6000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 3,
                    N_ITER =&gt; 1,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 2
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2"
 Guid="58f0fec8-e113-48e7-85d7-f80f65c15df3"
>
<Actions>
<Action
 Guid="49066d72-0377-486a-aa3b-c7e50eb697cf"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;[]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="7e206c0a-27d0-4c4f-ada7-b47cb9557324"
>(LAST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 7000.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="30131bd3-d3a7-49ec-a671-48bc4a91847a"
>(COUNT X IN Kernel.TrackDescription.Gradient.Gradients) == 3</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="07896fc9-99a6-4a32-af1d-6e4685bd478e"
>( FIRST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 4000.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase><TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 Name="Test case2 - Complete replacement"
 Guid="3212472c-aa6e-4d5c-94bb-941ad023b9f6"
>
<ReqRef
 Id="d8ccf575-2703-40a1-8aac-bf3fe6714fd5"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ad3066bf-141d-487d-8d43-044733ade82d"
>
</ReqRef><ReqRef
 Id="65fe6091-380a-44f6-8b7e-27202620ae3d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f6653f88-62e0-429e-8a27-317c231a1807"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Initialize train data"
 Guid="d61d8e47-3293-46ef-bc45-be9728aefb82"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="873ed92c-c2aa-40b0-b7a7-afabd04a6163"
>
<Actions>
<Action
 Guid="54543d30-7403-4494-876a-4773aadf9ea0"
>Testing.InitializeTestEnvironment
(
    aTrainPosition =&gt; 100.0,
    aMode =&gt; ModeEnum.SR
)</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Setup"
 Guid="e965372a-92cd-4f90-a12c-dc8d540e98bd"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="e90dc707-6468-437b-8c26-05f11a8401e3"
>
<Actions>
<Action
 Guid="b103f561-c1f0-4f0b-960e-aaa35939e1b1"
>Kernel.TrackDescription.Gradient.Gradients &lt;- []</Action><Action
 Guid="ed5d864c-695f-46c1-900e-352f65d9af18"
>INSERT BTM.LRBG.PreviousBaliseGroupStruct{
    BaliseGroup =&gt; BTM.LRBG.BaliseGroupStruct{
  NID_BG=&gt; 9616,
  Orientation=&gt; OrientationEnum.Nominal,
  Timestamp =&gt; Kernel.DateAndTime.Now(),
  Position=&gt; BTM.PositionStruct{
    OverReadingAmountOdo =&gt; 0.0,
    Position =&gt; 4000.0,
    UnderReadingAmountOdo =&gt; 0.0
  }
},
    IsLRBG =&gt; True,
    IsSingle =&gt; False
}

 IN BTM.LRBG.PreviousBaliseGroups</Action><Action
 Guid="f16b91b2-d8cf-46e7-950e-2e79dfd1b450"
>Odometry.NominalDistance &lt;- 4200.0</Action><Action
 Guid="f447faed-0f45-4a41-88e4-a7a3d27a0e89"
>BTM.Linking.Linkings &lt;- [BTM.Linking.LinkingDataStruct{
    LocationAccuracy =&gt; 5.0,
    Orientation =&gt; OrientationEnum.Nominal,
    Reaction =&gt; BTM.Linking.LinkingReaction.NoReaction,
    Distance =&gt; 200.0,
    BaliseGroupIdentifier =&gt; 2124
},BTM.Linking.LinkingDataStruct{
    LocationAccuracy =&gt; 5.0,
    Orientation =&gt; OrientationEnum.Nominal,
    Reaction =&gt; BTM.Linking.LinkingReaction.NoReaction,
    Distance =&gt; 0.0,
    BaliseGroupIdentifier =&gt; 2125
}]</Action><Action
 Guid="86f1d043-d952-4883-974e-2110669d415e"
>Kernel.Level.Value.Value &lt;- LevelEnum.L1</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive gradient profile"
 Guid="4134e682-acb5-4e03-9a63-76da5ba74aee"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="df24b2b6-d1f9-4b22-839a-6a581bbbcb10"
>
<Actions>
<Action
 Guid="f78a682e-ba12-4cdf-9fd9-930be7aa3168"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 4000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 2,
                    N_ITER =&gt; 3,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 2000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 1
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 4
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 5000,
                        Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                        G_A =&gt; 255
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="b4020933-4fde-48d8-a0c4-acb5e5f5c68c"
>(FIRST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 4000.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="e8a4813e-f8ff-4838-ac67-8aadc6627c75"
>(COUNT X IN Kernel.TrackDescription.Gradient.Gradients) == 4</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="74037130-be15-4677-8529-7b8f6ef19175"
>(LAST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 12000.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive new gradient profile with complete overwriting"
 Guid="5a49aa8f-f592-49b4-8622-127c29d7b5b4"
>
<Comment>Keep in mind: D_Gradient is an incemental value -- but Kernel.TrackDescription.Gradient.GradientInfo.Location holds an absolute value.</Comment>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="57cfecb4-1f8e-4d16-8e9e-e904ab864f00"
>
<Actions>
<Action
 Guid="5ce95675-a802-4d8b-a637-70fce7569797"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 3000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 3,
                    N_ITER =&gt; 1,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 2
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2"
 Guid="7768054d-eae5-46b6-82a2-d03ea6b05bd5"
>
<Actions>
<Action
 Guid="91efd198-3843-468a-a7f5-ae3ba05602b2"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;[]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="81dc99fd-acb7-421b-8ed6-aa430e2d0c13"
>( FIRST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 3000.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="5c2a06af-a5bc-4c55-8a8e-755a19109eba"
>(COUNT X IN Kernel.TrackDescription.Gradient.Gradients) == 2</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="6ff76243-5514-408c-99fd-b47c3830ae70"
>(LAST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 4000.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase><TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 Name="Test case3 - No replacement"
 Guid="659a1698-3747-4a45-bc2e-2986ba9626e5"
>
<ReqRef
 Id="d8ccf575-2703-40a1-8aac-bf3fe6714fd5"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0ca26d1a-26c0-4538-ade3-cf1054863aa0"
>
</ReqRef><ReqRef
 Id="65fe6091-380a-44f6-8b7e-27202620ae3d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8b1910ea-74d6-4f69-97ba-1b4f1d6de6ab"
>
</ReqRef><Steps>
<Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Initialize train data"
 Guid="64871374-1821-4de1-a058-616203365d6c"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="25acd318-2c6f-4fdf-807a-80a7cf571089"
>
<Actions>
<Action
 Guid="1aad55f8-579c-4508-918a-1d1750e7ea5f"
>Testing.InitializeTestEnvironment
(
    aTrainPosition =&gt; 100.0,
    aMode =&gt; ModeEnum.SR
)</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Setup"
 Guid="5e2581e6-4a3d-40ed-893d-707408c88445"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="c15f82e0-418c-4537-b88d-5d4ae091cc41"
>
<Actions>
<Action
 Guid="3b02bbfc-be20-4e6b-91c5-a0b5d42b1216"
>Kernel.TrackDescription.Gradient.Gradients &lt;- []</Action><Action
 Guid="4c565971-2de2-4517-86cb-6942cda5db17"
>INSERT BTM.LRBG.PreviousBaliseGroupStruct{
    BaliseGroup =&gt; BTM.LRBG.BaliseGroupStruct{
  NID_BG=&gt; 9616,
  Orientation=&gt; OrientationEnum.Nominal,
  Timestamp =&gt; Kernel.DateAndTime.Now(),
  Position=&gt; BTM.PositionStruct{
    OverReadingAmountOdo =&gt; 0.0,
    Position =&gt; 4000.0,
    UnderReadingAmountOdo =&gt; 0.0
  }
},
    IsLRBG =&gt; True,
    IsSingle =&gt; False
}

 IN BTM.LRBG.PreviousBaliseGroups</Action><Action
 Guid="604da6bb-b7a7-4d93-8ea8-9a68a6a24a1a"
>Odometry.NominalDistance &lt;- 4200.0</Action><Action
 Guid="95418f96-4a2f-41eb-af18-19e738efdad7"
>BTM.Linking.Linkings &lt;- [BTM.Linking.LinkingDataStruct{
    LocationAccuracy =&gt; 5.0,
    Orientation =&gt; OrientationEnum.Nominal,
    Reaction =&gt; BTM.Linking.LinkingReaction.NoReaction,
    Distance =&gt; 200.0,
    BaliseGroupIdentifier =&gt; 2124
},BTM.Linking.LinkingDataStruct{
    LocationAccuracy =&gt; 5.0,
    Orientation =&gt; OrientationEnum.Nominal,
    Reaction =&gt; BTM.Linking.LinkingReaction.NoReaction,
    Distance =&gt; 0.0,
    BaliseGroupIdentifier =&gt; 2125
}]</Action><Action
 Guid="24739d13-96ff-48f0-b9ea-b73ed3c378d1"
>Kernel.Level.Value.Value &lt;- LevelEnum.L1</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive gradient profile"
 Guid="c7d4f2a1-328b-427f-847f-d71dec142d0b"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="bace3652-2cdb-4aca-95b8-d15b3e727c3e"
>
<Actions>
<Action
 Guid="9f0d6a2a-42a0-41cf-8cb1-facb0fcc6a7c"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 4000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 2,
                    N_ITER =&gt; 3,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 2000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 1
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 4
                      },
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 5000,
                        Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                        G_A =&gt; 255
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 Guid="53112f5b-9139-4f1c-a046-557858a6f24a"
>(FIRST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 4000.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="6df27e42-79e4-4cbb-9806-1532ab71d098"
>(COUNT X IN Kernel.TrackDescription.Gradient.Gradients) == 4</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="fc64f8ab-618a-49e8-af34-e40d81983f0e"
>(LAST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 12000.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Receive new gradient profile with no overwriting"
 Guid="bba5e079-4afa-4ebf-a3d6-386db81c7de5"
>
<Comment>Keep in mind: D_Gradient is an incemental value -- but Kernel.TrackDescription.Gradient.GradientInfo.Location holds an absolute value.</Comment>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="e84ea484-d462-408b-bb8f-2d087d32ed8b"
>
<Actions>
<Action
 Guid="20f7ef47-5637-434f-adaf-bce9105b6d25"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [
        Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                GRADIENT_PROFILE =&gt; Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.Message
                {
                    NID_PACKET=&gt;21,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    D_GRADIENT =&gt; 13000,
                    Q_GDIR =&gt; Messages.Q_GDIR.uphill,
                    G_A =&gt; 3,
                    N_ITER =&gt; 1,
                    Sequence1 =&gt; [
                      Messages.PACKET.TRACK_TO_TRAIN.GRADIENT_PROFILE.SubStructure1 {
                        D_GRADIENT =&gt; 1000,
                        Q_GDIR =&gt; Messages.Q_GDIR.downhill,
                        G_A =&gt; 2
                      }
                    ]
                }
            }
        }
    ]
}</Action></Actions>
</SubStep><SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step2"
 Guid="905c990c-29ff-4f81-a2ce-2f3275cb26d9"
>
<Actions>
<Action
 Guid="fc966be1-45e9-499b-a77d-49d064c97d07"
>BTM.Message.SystemVersion2 &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;32,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;1,
    N_TOTAL=&gt;1,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2125,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;[]
}</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 Distance="0"
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Check that no overwriting has occured"
 Guid="741662e0-21ae-4f73-b95b-9c341de5dc95"
>
<SubSteps>
<SubStep
 TimeDelay="NotDelayed"
 Name="Sub-step1"
 Guid="8de2f2c5-57bd-4606-a78a-e86d7c5bc974"
>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="653a25e5-95bd-43ad-81db-3952b18f82ad"
>( FIRST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 4000.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="df11c7f9-02c8-4ae1-963d-0085ca0b62da"
>(COUNT X IN Kernel.TrackDescription.Gradient.Gradients) == 6</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="59d6e607-f72e-4647-ab15-6abc50f1ff68"
>(LAST X IN Kernel.TrackDescription.Gradient.Gradients).Location == 14000.0</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase></TestCases>
</SubSequence></SubSequences>
</Frame>
